<!DOCTYPE html>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Slides from FYS3150/4150 Lectures">

<title>Slides from FYS3150/4150 Lectures</title>






<!-- reveal.js: http://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- If the query includes 'print-pdf', use the PDF print sheet -->
<script>
document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
</script>

<style type="text/css">
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .reveal .alert-text-small   { font-size: 80%;  }
    .reveal .alert-text-large   { font-size: 130%; }
    .reveal .alert-text-normal  { font-size: 90%;  }
    .reveal .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:5px solid #bababa;
             -webkit-border-radius: 14px; -moz-border-radius: 14px;
             border-radius:14px
             background-position: 10px 10px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 30px; /* 55px; if icon */
     }
     .reveal .alert-block {padding-top:14px; padding-bottom:14px}
     .reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
     /*.reveal .alert li {margin-top: 1em}*/
     .reveal .alert-block p+p {margin-top:5px}
     /*.reveal .alert-notice { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
     .reveal .alert-summary  { background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
     .reveal .alert-warning { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
     .reveal .alert-question {background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */

</style>



<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>

<body>
<div class="reveal">

<!-- Any section element inside the <div class="slides"> container
     is displayed as a slide -->

<div class="slides">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    



<section>
<!-- ------------------- main content ---------------------- -->



<center><h1>Slides from FYS3150/4150 Lectures</h1></center>  <!-- document title -->

<p>
<!-- author(s): Morten Hjorth-Jensen -->

<center>
<b>Morten Hjorth-Jensen</b> [1, 2]
</center>


<p>&nbsp;<br>
<!-- institution(s) -->

<center>[1] <b>Department of Physics and Center of Mathematics for Applications, University of Oslo</b></center>
<center>[2] <b>National Superconducting Cyclotron Laboratory, Michigan State University</b></center>
<p>&nbsp;<br>
<center><h4>Aug 29, 2014</h4></center> <!-- date -->
<p>

</section>


<section>

<h1>Week 34  <a name="___sec0"></a></h1>


</section>


<section>

<h2>Overview of week 34  <a name="___sec1"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <p><li> Monday: First lecture: Presentation of the course, aims and content</li>
  <p><li> Monday: Second Lecture: Introduction to C++ programming and numerical precision.</li>
  <p><li> Tuesday: Numerical precision and C++ programming, continued and exercises for first week</li>
  <p><li> Numerical differentiation and loss of numerical precision (chapter 3 lecture notes)</li>
  <p><li> Computer lab: Thursday and Friday. First time: Thursday and Friday this week, Presentation of hardware and software at room FV329 first hour of every labgroup and solution of first simple exercises.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Lectures and ComputerLab  <a name="___sec2"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <p><li> Lectures: Monday (4.15pm-6pm) and Tuesday (12.15pm-2pm) only this and next week. Thereafter weeks 38 and 39, and weeks 43 and 44 and finally weeks 47 and 48.</li>
  <p><li> Weekly reading assignments needed to solve projects.</li>
  <p><li> First hour of each lab session used to discuss technicalities, address questions etc linked with projects.</li>
  <p><li> Detailed lecture notes, exercises, all programs presented, projects etc can be found at the homepage of the course.</li>
  <p><li> Computerlab: Thursday (9am-7pm) and Friday (9am-7pm) room FV329.</li>
  <p><li> Weekly plans and all other information are on the official webpage.</li>
  <p><li> Final written exam December 12, 9am (four hours).</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Course Format  <a name="___sec3"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <p><li> Several computer exercises, 5 compulsory projects. Electronic reports only.</li>
  <p><li> Evaluation and grading: The last project (50% of final grade) and a  final written exam (50% of final grade). Final written exam December 12.</li>
  <p><li> The computer lab (room FV329)consists of 16 Linux PCs, but many prefer own laptops. C/C++ is the default programming language, but Fortran2008 and Python are also used. All source codes discussed during the lectures can be found at the webpage of the course. We recommend either C/C++, Fortran2008 or Python as languages.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>ComputerLab  <a name="___sec4"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
<table border="1">
<thead>
<tr><th align="center">                day                </th> <th align="center">              teacher              </th> </tr>
</thead>
<tbody>
<tr><td align="left">   Thursday 9am-1pm                       </td> <td align="left">   Anders, Morten L., H&#229;vard, MHJ    </td> </tr>
<tr><td align="left">   Thursday 1pm-5pm                       </td> <td align="left">   Anders, Morten L., H&#229;vard, MHJ    </td> </tr>
<tr><td align="left">   Friday 9am-1pm                         </td> <td align="left">   Anders, Morten L., H&#229;vard, MHJ    </td> </tr>
<tr><td align="left">   Friday 1pm-5pm                         </td> <td align="left">   Anders, Morten L., H&#229;vard, MHJ    </td> </tr>
</tbody>
</table>

</div>


<p>

</section>


<section>

<h2>Topics covered in this course  <a name="___sec5"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <p><li> Numerical precision and intro to C++ programming</li>
  <p><li> Numerical derivation and integration</li>
  <p><li> Random numbers and Monte Carlo integration</li>
  <p><li> Monte Carlo methods in statistical physics</li>
  <p><li> Quantum Monte Carlo methods</li>
  <p><li> Linear algebra and eigenvalue problems</li>
  <p><li> Non-linear equations and roots of polynomials</li>
  <p><li> Ordinary differential equations</li>
  <p><li> Partial differential equations</li>
  <p><li> Parallelization of codes</li>
  <p><li> Programming av GPUs (optional)</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Syllabus FYS3150  <a name="___sec6"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Linear algebra and eigenvalue problems, chapters 6 and 7.</b>
<p>

<ul>
  <p><li> Know Gaussian elimination and LU decomposition</li>
  <p><li> How to solve linear equations</li>
  <p><li> How to obtain the inverse and the determinant of a real symmetric matrix</li>
  <p><li> Cholesky and tridiagonal matrix decomposition</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Syllabus FYS3150  <a name="___sec7"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Linear algebra and eigenvalue problems, chapters 6 and 7.</b>
<p>

<ul>
  <p><li> Householder's tridiagonalization technique and finding eigenvalues based on this</li>
  <p><li> Jacobi's method for finding eigenvalues</li>
  <p><li> Singular value decomposition</li>
  <p><li> Qubic Spline interpolation</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Syllabus FYS3150  <a name="___sec8"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Numerical integration, standard methods and Monte Carlo methods (chapters 4 and 11).</b>
<p>

<ul>
  <p><li> Trapezoidal, rectangle and Simpson's rules</li>
  <p><li> Gaussian quadrature, emphasis on Legendre polynomials, but you need to know about other polynomials as well.</li>
  <p><li> Brute force Monte Carlo integration</li>
  <p><li> Random numbers (simplest algo, ran0) and probability distribution functions, expectation values</li>
  <p><li> Improved Monte Carlo integration and importance sampling.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Syllabus FYS3150  <a name="___sec9"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Monte Carlo methods in physics (chapters 12, 13, and 14).</b>
<p>

<ul>
  <p><li> Random walks and Markov chains and relation with diffusion equation</li>
  <p><li> Metropolis algorithm, detailed balance and ergodicity</li>
  <p><li> Simple spin systems and phase transitions</li>
  <p><li> Variational Monte Carlo</li>
  <p><li> How to construct trial wave functions for quantum systems</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Syllabus FYS3150  <a name="___sec10"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Ordinary differential equations (chapters 8 and 9).</b>
<p>

<ul>
  <p><li> Euler's method and improved Euler's method, truncation errors</li>
  <p><li> Runge Kutta methods, 2nd and 4th order, truncation errors</li>
  <p><li> How to implement a second-order differential equation, both linear and non-linear. How to make your equations dimensionless.</li>
  <p><li> Boundary value problems, shooting and matching method (chap 9).</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Syllabus FYS3150  <a name="___sec11"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Partial differential equations, chapter 10.</b>
<p>

<ul>
  <p><li> Set up diffusion, Poisson and wave equations up to 2 spatial dimensions and time</li>
  <p><li> Set up the mathematical model and algorithms for these equations, with boundary and initial conditions. Their stability conditions.</li>
  <p><li> Explicit, implicit and Crank-Nicolson schemes, and how to solve them. Remember that they result in triangular matrices.</li>
  <p><li> How to compute the Laplacian in Poisson's equation.</li>
  <p><li> How to solve the wave equation in one and two dimensions.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Overarching aims of this course  <a name="___sec12"></a></h2>

<ul>
  <p><li> Develop a critical approach to all steps in a project, which methods are most relevant, which natural laws and physical processes are important. Sort out initial conditions and boundary conditions etc.</li>
  <p><li> This means to teach you structured scientific computing, learn to structure a project.</li>
  <p><li> A critical understanding of central mathematical algorithms and methods from numerical analysis. In particular their limits and stability criteria.</li>
  <p><li> Always try to find good checks of your codes (like solutions on closed form)</li>
  <p><li> To enable you to develop a critical view on the mathematical model and the physics.</li>
</ul>
<p>


</section>


<section>

<h2>And, there is nothing like a code which gives correct results!!  <a name="___sec13"></a></h2>

<center><p><img src="fig-slides1/Nebbdyr2.png" align="bottom" width=500></p></center>

<ul>
 <p><li> J. J. Barton and L. R. Nackman,*Scientific and Engineering C++*, Addison Wesley, 3rd edition 2000.</li>
 <p><li> B. Stoustrup, <em>The C++ programming language</em>, Pearson, 1997.</li>
 <p><li> H. P. Langtangen INF-VERK3830 <a href="http://heim.ifi.uio.no/~hpl/INF-VERK4830/" target="_blank"><tt>http://heim.ifi.uio.no/~hpl/INF-VERK4830/</tt></a></li>
 <p><li> D. Yang, <em>C++ and Object-oriented Numeric Computing for Scientists and Engineers</em>, Springer 2000.</li>
 <p><li> More books reviewed at <a href="http:://www.accu.org/" target="_blank"><tt>http:://www.accu.org/</tt></a> and <a href="http://www.comeaucomputing.com/booklist/" target="_blank"><tt>http://www.comeaucomputing.com/booklist/</tt></a></li>
</ul>
<p>


</section>


<section>

<h2>Other courses in Computational Science at UiO  <a name="___sec14"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Bachelor/Master/PhD Courses.</b>
<p>

<ul>
  <p><li> INF-MAT4350 Numerical linear algebra</li>
  <p><li> MAT-INF3300/3310, PDEs and Sobolev spaces I and II</li>
  <p><li> INF-MAT3360 PDEs</li>
  <p><li> INF5620 Numerical methods for PDEs, finite element method</li>
  <p><li> FYS4411 Computational physics II (Parallelization (MPI), object orientation, quantum mechanical systems with many interacting particles), spring semester</li>
  <p><li> FYS4460 Computational physics III (Parallelization (MPI), object orientation, classical statistical physics, simulation of phase transitions, spring semester</li>
  <p><li> INF3331 Problem solving with high-level languages (Python), fall semester</li>
  <p><li> INF3380 Parallel computing for problems in the Natural Sciences (mostly PDEs), spring semester</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Extremely useful tools, strongly recommended  <a name="___sec15"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>and discussed at the lab sessions the first week.</b>
<p>

<ul>
  <p><li> GIT for version control (see webpage)</li>
  <p><li> ipython notebook</li>
  <p><li> QTcreator for editing and mastering computational projects (for C++ codes, see webpage of course)</li>
  <p><li> Armadillo as a useful numerical library for C++, highly recommended</li>
  <p><li> Unit tests, see also webpage</li>
  <p><li> Devilry for handing in projects</li>
</ul>
</div>


<p>

</section>


<section>

<h2>A structured programming approach  <a name="___sec16"></a></h2>

<ul>
  <p><li> Before writing a single line, have the algorithm clarified and understood. It is crucial to have a logical structure of e.g., the flow and organization of data before one starts writing.</li>
  <p><li> Always try to choose the simplest algorithm. Computational speed can be improved upon later.</li>
  <p><li> Try to write a as clear program as possible. Such programs are easier to debug, and although it may take more time, in the long run it may save you time. If you collaborate with other people, it reduces spending time on debuging and trying to understand what the codes do. A clear program will also allow you to remember better what the program really does!</li>
</ul>
<p>


</section>


<section>

<h2>A structured programming approach  <a name="___sec17"></a></h2>

<ul>
  <p><li> The planning of the program should be from top down to bottom, trying to keep the flow as linear as possible. Avoid jumping back and forth in the program. First you need to arrange the major tasks to be achieved. Then try to break the major tasks into subtasks. These can be represented by functions or subprograms. They should accomplish limited tasks and as far as possible be independent of each other. That will allow you to use them in other programs as well.</li>
  <p><li> Try always to find some cases where an analytical solution exists or where simple test cases can be applied. If possible, devise different algorithms for solving the same problem. If you get the same answers, you may have coded things correctly or made the same error twice or more.</li>
</ul>
<p>


</section>


<section>

<h2>Getting Started  <a name="___sec18"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Compiling and linking, without QTcreator.</b>
<p>
In order to obtain an executable file for a C++ program, the following
instructions under Linux/Unix can be used

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">c++</span> <span style="color: #d0d0d0">-c</span> <span style="color: #d0d0d0">-Wall</span> <span style="color: #d0d0d0">myprogram.cpp</span>
<span style="color: #d0d0d0">c++</span> <span style="color: #d0d0d0">-o</span> <span style="color: #d0d0d0">myprogram</span> <span style="color: #d0d0d0">myprogram.o</span>
</pre></div>
<p>
where the compiler is called through the command c++/g++. The compiler
option -Wall means that a warning is issued in case of non-standard
language. The executable file is in this case <code>myprogram</code>. The option
<code>-c</code> is for compilation only, where the program is translated into machine code,
while the <code>-o</code> option links the produced object file <code>myprogram.o</code>
and produces the executable <code>myprogram</code> .

<p>
For Fortran2008 we use the Intel compiler, replace <code>c++</code> with <code>ifort</code>.
Also, to speed up the code use compile options like

<p>

<!-- code=text (!bc sys) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">c++ -O3 -c -Wall myprogram.cpp
</pre></div>

</div>


<p>

</section>


<section>

<h2>Makefiles and simple scripts  <a name="___sec19"></a></h2>

Under Linux/Unix it is often convenient to create a
so-called makefile, which is a script which includes possible
compiling commands.

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #cd2828; font-weight: bold"># Comment lines</span>
<span style="color: #cd2828; font-weight: bold"># General makefile for c - choose PROG =   name of given program</span>
<span style="color: #cd2828; font-weight: bold"># Here we define compiler option, libraries and the  target</span>
<span style="color: #d0d0d0">CC=</span> <span style="color: #d0d0d0">g++</span> <span style="color: #d0d0d0">-Wall</span>
<span style="color: #d0d0d0">PROG=</span> <span style="color: #d0d0d0">myprogram</span>
<span style="color: #cd2828; font-weight: bold"># this is the math library in C, not necessary for C++</span>
<span style="color: #d0d0d0">LIB</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">-lm</span>
<span style="color: #cd2828; font-weight: bold"># Here we make the executable file</span>
<span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{PROG}</span> <span style="color: #d0d0d0">:</span>          <span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{PROG}.o</span>
                   <span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{CC}</span> <span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{PROG}.o</span> <span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{LIB}</span> <span style="color: #d0d0d0">-o</span> <span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{PROG}</span>
<span style="color: #cd2828; font-weight: bold"># whereas here we create the object file</span>
<span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{PROG}.o</span> <span style="color: #d0d0d0">:</span>       <span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{PROG}.c</span>
                  <span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{CC}</span> <span style="color: #d0d0d0">-c</span> <span style="color: #a61717; background-color: #e3d2d2">$</span><span style="color: #d0d0d0">{PROG}.c</span>
</pre></div>
<p>
If you name your file for <code>makefile</code>, simply type the command
<code>make</code> and Linux/Unix executes all of the statements in the above
makefile. Note that C++ files have the extension <code>.cpp</code>.

<p>

</section>


<section>

<h2>Hello world  <a name="___sec20"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>The C encounter.</b>
<p>
Here we present first the C version.

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">/* comments in C begin like this and end with */</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;stdlib.h&gt; </span><span style="color: #999999; font-style: italic">/* atof function */</span><span style="color: #cd2828; font-weight: bold"></span>
<span style="color: #cd2828; font-weight: bold">#include &lt;math.h&gt;   </span><span style="color: #999999; font-style: italic">/* sine function */</span><span style="color: #cd2828; font-weight: bold"></span>
<span style="color: #cd2828; font-weight: bold">#include &lt;stdio.h&gt;  </span><span style="color: #999999; font-style: italic">/* printf function */</span><span style="color: #cd2828; font-weight: bold"></span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">argv[])</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">r,</span> <span style="color: #d0d0d0">s;</span>        <span style="color: #999999; font-style: italic">/* declare variables */</span>
  <span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">atof(argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]);</span>  <span style="color: #999999; font-style: italic">/* convert the text argv[1] to double */</span>
  <span style="color: #d0d0d0">s</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">sin(r);</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Hello, World! sin(%g)=%g\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">r,</span> <span style="color: #d0d0d0">s);</span>
  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>           <span style="color: #999999; font-style: italic">/* success execution of the program */</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Hello World  <a name="___sec21"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Dissection I.</b>
<p>
The compiler must see a declaration of a function before you can
call it (the compiler checks the argument and return types).
The declaration of library functions appears
in so-called &quot;header files&quot; that must be included in the program, e.g.,

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #a61717; background-color: #e3d2d2">#</span><span style="color: #d0d0d0">include</span> <span style="color: #d0d0d0">&lt;stdlib.h&gt;</span> <span style="color: #999999; font-style: italic">/* atof function */</span>
</pre></div>
<p>
We call three functions (atof, sin, printf)
and these are declared in three different header files.
The main program is a function called main
with a return value set to an integer, int (0 if success).
The operating system stores the return value,
and other programs/utilities can check whether
the execution was successful or not.
The command-line arguments are transferred to the main function through

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">main</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">argv[])</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Hello World  <a name="___sec22"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Dissection II.</b>
<p>
The command-line arguments are transferred to the main function through

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">main</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">argv[])</span>
</pre></div>
<p>
The integer <code>argc</code> is the no of command-line arguments, set to
one in our case, while
<code>argv</code> is a vector of strings containing the command-line arguments
with <code>argv[0]</code> containing  the name of the program
and <code>argv[1]</code>, <code>argv[2]</code>, ... are the command-line args, i.e., the number of
lines of input to the program.
Here we define floating points, see also below,
through the keywords <code>float</code> for single precision real numbers and
<code>double</code> for double precision. The function
<code>atof</code> transforms a text (<code>argv[1]</code>) to a float.
The sine function is declared in math.h, a library which
is not automatically included and needs to be linked when computing
an executable file.

<p>
With the command <code>printf</code> we obtain a formatted printout.
The <code>printf</code> syntax is used for formatting output
in many C-inspired languages (Perl, Python, Awk, partly C++).
</div>


<p>

</section>


<section>

<h2>Hello World  <a name="___sec23"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Now in C++.</b>
<p>
Here we present first the C++ version.

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">// A comment line begins like this in C++ programs</span>
<span style="color: #999999; font-style: italic">// Standard ANSI-C++ include files</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;  </span><span style="color: #999999; font-style: italic">// input and output</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">main</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">argv[])</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #999999; font-style: italic">// convert the text argv[1] to double using atof:</span>
  <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">atof(argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]);</span>
  <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">s</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">sin(r);</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Hello, World! sin(&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;)=&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">s</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&#39;\n&#39;</span><span style="color: #d0d0d0">;</span>
  <span style="color: #999999; font-style: italic">// success</span>
  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">}</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>C++ Hello World  <a name="___sec24"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Dissection I.</b>
<p>
We have replaced the call to <code>printf</code> with the standard C++ function
<code>cout</code>. The header file <code><iostream.h></code> is then needed.
In addition, we don't need to
declare variables like <code>r</code> and <code>s</code>  at the beginning of the program.
I personally prefer
however to declare all variables at the beginning of a function, as this
gives <em>me</em> a feeling of greater readability.
</div>


<p>

</section>


<section>

<h2>Brief summary  <a name="___sec25"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>C/C++ program.</b>
<p>

<ul>
  <p><li> A C/C++ program begins with include statements of header files (libraries,intrinsic functions etc)</li>
  <p><li> Functions which are used are normally defined at top (details next week)</li>
  <p><li> The main program is set up as an integer, it returns 0 (everything correct) or 1 (something went wrong)</li>
  <p><li> Standard <code>if</code>, <code>while</code> and <code>for</code> statements as in Java, Fortran, Python...</li>
  <p><li> Integers have a very limited range.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Brief summary  <a name="___sec26"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Arrays.</b>
<p>

<ul>
  <p><li> A C/C++ array begins by indexing at 0!</li>
  <p><li> Array allocations are done by size, not by the final index value.If you allocate an array with 10 elements, you should index them from \( 0,1,\dots, 9 \).</li>
  <p><li> Initialize always an array before a computation.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Serious problems and representation of numbers  <a name="___sec27"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Integer and Real Numbers.</b>
<p>

<ul>
  <p><li> Overflow</li>
  <p><li> Underflow</li>
  <p><li> Roundoff errors</li>
  <p><li> Loss of precision</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Limits, you must declare variables  <a name="___sec28"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>C++ and Fortran declarations.</b>
<p>

<p>
<table border="1">
<thead>
<tr><th align="center">            type in C/C++ and Fortran2008             </th> <th align="center">                         bits                         </th> <th align="center">                        range                         </th> </tr>
</thead>
<tbody>
<tr><td align="left">   <code>int/INTEGER</code> (2)                              </td> <td align="center">   16                                                        </td> <td align="left">   -32768 to 32767                                           </td> </tr>
<tr><td align="left">   <code>unsigned int</code>                                 </td> <td align="center">   16                                                        </td> <td align="left">   0 to 65535                                                </td> </tr>
<tr><td align="left">   <code>signed int</code>                                   </td> <td align="center">   16                                                        </td> <td align="left">   -32768 to 32767                                           </td> </tr>
<tr><td align="left">   <code>short int</code>                                    </td> <td align="center">   16                                                        </td> <td align="left">   -32768 to 32767                                           </td> </tr>
<tr><td align="left">   <code>unsigned short int</code>                           </td> <td align="center">   16                                                        </td> <td align="left">   0 to 65535                                                </td> </tr>
<tr><td align="left">   <code>signed short int</code>                             </td> <td align="center">   16                                                        </td> <td align="left">   \( -32768 \) to 32767                                     </td> </tr>
<tr><td align="left">   <code>int/long int/INTEGER</code> (4)                     </td> <td align="center">   32                                                        </td> <td align="left">   -2147483648 to 2147483647                                 </td> </tr>
<tr><td align="left">   <code>signed long int</code>                              </td> <td align="center">   32                                                        </td> <td align="left">   -2147483648 to 2147483647                                 </td> </tr>
<tr><td align="left">   <code>float/REAL(4)</code>                                </td> <td align="center">   32                                                        </td> <td align="left">   \( 3.4\times 10^{-44} \) to \( 3.4\times 10^{+38} \)      </td> </tr>
<tr><td align="left">   <code>double/REAL(8)</code>                               </td> <td align="center">   64                                                        </td> <td align="left">   \( 1.7\times 10^{-322} \) to \( 1.7\times 10^{+308} \)    </td> </tr>
<tr><td align="left">   <code>long double</code>                                  </td> <td align="center">   64                                                        </td> <td align="left">   \( 1.7\times 10^{-322} \) to \( 1.7\times 10^{+308} \)    </td> </tr>
</tbody>
</table>

</div>


<p>

</section>


<section>

<h2>From decimal to binary representation  <a name="___sec29"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>How to do it.</b>
<p>
<p>&nbsp;<br>
$$
  a_n2^n+a_{n-1}2^{n-1}  +a_{n-2}2^{n-2}  +\dots +a_{0}2^{0}.
$$
<p>&nbsp;<br>


<p>
In binary notation we have thus \( (417)_{10} =(110110001)_2 \)
since we have

<p>&nbsp;<br>
$$
(110100001)_2
=1\times2^8+1\times 2^{7}+0\times 2^{6}+1\times 2^{5}+0\times 2^{4}+0\times 2^{3}+0\times 2^{2}+0\times 2^{2}+0\times 2^{1}+1\times 2^{0}.
$$
<p>&nbsp;<br>

To see this, we have performed the following divisions by 2

<p>
<table border="1">
<tr></tr>
<tbody>
<tr><td align="center">   417/2=208                          </td> <td align="center">   remainder 1                        </td> <td align="center">   coefficient of \( 2^{0} \) is 1    </td> </tr>
<tr><td align="center">   208/2=104                          </td> <td align="center">   remainder 0                        </td> <td align="center">   coefficient of \( 2^{1} \) is 0    </td> </tr>
<tr><td align="center">   104/2=52                           </td> <td align="center">   remainder 0                        </td> <td align="center">   coefficient of \( 2^{2} \) is 0    </td> </tr>
<tr><td align="center">   52/2=26                            </td> <td align="center">   remainder 0                        </td> <td align="center">   coefficient of \( 2^{3} \) is 0    </td> </tr>
<tr><td align="center">   26/2=13                            </td> <td align="center">   remainder 1                        </td> <td align="center">   coefficient of \( 2^{4} \) is 0    </td> </tr>
<tr><td align="center">   13/2= 6                            </td> <td align="center">   remainder 1                        </td> <td align="center">   coefficient of \( 2^{5} \) is 1    </td> </tr>
<tr><td align="center">   6/2= 3                             </td> <td align="center">   remainder 0                        </td> <td align="center">   coefficient of \( 2^{6} \) is 0    </td> </tr>
<tr><td align="center">   3/2= 1                             </td> <td align="center">   remainder 1                        </td> <td align="center">   coefficient of \( 2^{7} \) is 1    </td> </tr>
<tr><td align="center">   1/2= 0                             </td> <td align="center">   remainder 1                        </td> <td align="center">   coefficient of \( 2^{8} \) is 1    </td> </tr>
</tbody>
</table>

</div>


<p>

</section>


<section>

<h2>From decimal to binary representation  <a name="___sec30"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Integer numbers.</b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">argv[])</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">i;</span>
  <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">terms[</span><span style="color: #3677a9">32</span><span style="color: #d0d0d0">];</span> <span style="color: #999999; font-style: italic">// storage of a0, a1, etc, up to 32 bits</span>
  <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">number</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">atoi(argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]);</span>
  <span style="color: #999999; font-style: italic">// initialise the term a0, a1 etc</span>
  <span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">(i=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #3677a9">32</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++){</span> <span style="color: #d0d0d0">terms[i]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;}</span>
  <span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">(i=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #3677a9">32</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++){</span>
    <span style="color: #d0d0d0">terms[i]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">number%</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">;</span>
    <span style="color: #d0d0d0">number</span> <span style="color: #d0d0d0">/=</span> <span style="color: #3677a9">2</span><span style="color: #d0d0d0">;</span>

  <span style="color: #999999; font-style: italic">// write out results</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Number of bytes used= &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #6ab825; font-weight: bold">sizeof</span><span style="color: #d0d0d0">(number)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">(i=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #3677a9">32</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++){</span>
    <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot; Term nr: &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Value= &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">terms[i];</span>
    <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>

  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>From decimal to binary representation  <a name="___sec31"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Integer numbers, Fortran.</b>
<p>
<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">PROGRAM </span><span style="color: #40ffff">binary_integer</span>
<span style="color: #6ab825; font-weight: bold">IMPLICIT NONE</span>
<span style="color: #6ab825; font-weight: bold">  INTEGER  </span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">number</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">terms</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">:</span><span style="color: #3677a9">31</span><span style="color: #d0d0d0">)</span> <span style="color: #999999; font-style: italic">! storage of a0, a1, etc, up to 32 bits</span>

  <span style="color: #6ab825; font-weight: bold">WRITE</span><span style="color: #d0d0d0">(*,*)</span> <span style="color: #ed9d13">&#39;Give a number to transform to binary notation&#39;</span>
  <span style="color: #6ab825; font-weight: bold">READ</span><span style="color: #d0d0d0">(*,*)</span> <span style="color: #40ffff">number</span>
<span style="color: #999999; font-style: italic">! Initialise the terms a0, a1 etc</span>
  <span style="color: #40ffff">terms</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span>
<span style="color: #999999; font-style: italic">! Fortran takes only integer loop variables</span>
  <span style="color: #6ab825; font-weight: bold">DO </span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">31</span>
     <span style="color: #40ffff">terms</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">MOD</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">number</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">)</span>
     <span style="color: #40ffff">number</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">number</span><span style="color: #d0d0d0">/</span><span style="color: #3677a9">2</span>
  <span style="color: #40ffff">ENDDO</span>
<span style="color: #999999; font-style: italic">! write out results</span>
  <span style="color: #6ab825; font-weight: bold">WRITE</span><span style="color: #d0d0d0">(*,*)</span> <span style="color: #ed9d13">&#39;Binary representation &#39;</span>
  <span style="color: #6ab825; font-weight: bold">DO </span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">31</span>
    <span style="color: #6ab825; font-weight: bold">WRITE</span><span style="color: #d0d0d0">(*,*)</span><span style="color: #ed9d13">&#39; Term nr and value&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">i</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">terms</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">)</span>
  <span style="color: #40ffff">ENDDO</span>

<span style="color: #6ab825; font-weight: bold">END PROGRAM </span><span style="color: #40ffff">binary_integer</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Integer Numbers  <a name="___sec32"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Possible Overflow for Integers.</b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">// A comment line begins like this in C++ programs</span>
<span style="color: #999999; font-style: italic">// Program to calculate 2**n</span>
<span style="color: #999999; font-style: italic">// Standard ANSI-C++ include files */</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;cmath&gt;</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">main()</span>
<span style="color: #d0d0d0">{</span>
   <span style="color: #6ab825; font-weight: bold">int</span>  <span style="color: #d0d0d0">int1,</span> <span style="color: #d0d0d0">int2,</span> <span style="color: #d0d0d0">int3;</span>
<span style="color: #999999; font-style: italic">// print to screen</span>
   <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Read in the exponential N for 2^N =\n&quot;</span><span style="color: #d0d0d0">;</span>
<span style="color: #999999; font-style: italic">// read from screen</span>
   <span style="color: #d0d0d0">cin</span> <span style="color: #d0d0d0">&gt;&gt;</span> <span style="color: #d0d0d0">int2;</span>
   <span style="color: #d0d0d0">int1</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">pow(</span><span style="color: #3677a9">2.</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">int2);</span>
   <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot; 2^N * 2^N = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">int1*int1</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>
   <span style="color: #d0d0d0">int3</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">int1</span> <span style="color: #d0d0d0">-</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">;</span>
   <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot; 2^N*(2^N - 1) = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">int1</span> <span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">int3</span>  <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>
   <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot; 2^N- 1 = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">int3</span>  <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>
   <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>

<span style="color: #999999; font-style: italic">// End: program main()</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Loss of Precision  <a name="___sec33"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Machine Numbers.</b>
<p>
In the decimal system we would write a number like \( 9.90625 \)
in what is called the normalized scientific notation.

<p>&nbsp;<br>
$$
  9.90625=0.990625\times 10^{1},
$$
<p>&nbsp;<br>

and a real non-zero number could be generalized as

<p>&nbsp;<br>
$$
\begin{equation}
    x=\pm r\times 10^{{\mbox{n}}},
\end{equation}
$$
<p>&nbsp;<br>

with \( r \) a number in the range \( 1/10 \le r < 1 \).
In a similar way we can use represent a binary number in
scientific notation as

<p>&nbsp;<br>
$$
\begin{equation}
    x=\pm q\times 2^{{\mbox{m}}},
\end{equation}
$$
<p>&nbsp;<br>

with \( q \) a number in the range \( 1/2 \le q < 1 \).
This means that the mantissa of a binary number would be represented by
the general formula

<p>&nbsp;<br>
$$
\begin{equation}
(0.a_{-1}a_{-2}\dots a_{-n})_2=a_{-1}\times 2^{-1}
+a_{-2}\times 2^{-2}+\dots+a_{-n}\times 2^{-n}.
\end{equation}
$$
<p>&nbsp;<br>
</div>


<p>

</section>


<section>

<h2>Loss of Precision  <a name="___sec34"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Machine Numbers.</b>
<p>
In a typical computer, floating-point numbers are represented
in the way described above, but with certain restrictions
on \( q \) and \( m \) imposed by the available word length.
In the machine, our
number \( x \) is represented as

<p>&nbsp;<br>
$$
\begin{equation}
    x=(-1)^s\times {\mbox{mantissa}}\times 2^{{\mbox{exponent}}},
\end{equation}
$$
<p>&nbsp;<br>


<p>
where \( s \) is the sign bit, and the exponent gives the available range.
With a single-precision word, 32 bits, 8 bits would typically be reserved
for the exponent,  1 bit for the sign and 23 for the mantissa.
</div>


<p>

</section>


<section>

<h2>Loss of Precision  <a name="___sec35"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Machine Numbers.</b>
<p>
A modification of the scientific notation for binary numbers is to
require that the leading binary digit 1 appears to the left of the binary point.
In this case the representation of the mantissa \( q \) would be
\( (1.f)_2 \) and $ 1 \le q < 2$. This form is rather useful when storing
binary numbers in a computer word, since we can always assume that the leading
bit 1 is there. One bit of space can then be saved meaning that a 23 bits
mantissa has actually 24 bits. This means explicitely that a binary number with 23 bits
for the mantissa reads

<p>&nbsp;<br>
$$
\begin{equation}
(1.a_{-1}a_{-2}\dots a_{-23})_2=1\times 2^0+a_{-1}\times 2^{-1}+
+a_{-2}\times 2^{-2}+\dots+a_{-23}\times 2^{-23}.
\end{equation}
$$
<p>&nbsp;<br>

As an example, consider the 32 bits binary number

<p>&nbsp;<br>
$$
(10111110111101000000000000000000)_2,
$$
<p>&nbsp;<br>

where the first bit is reserved for the sign, 1 in this case yielding a
negative sign. The exponent \( m \) is given by the next 8 binary numbers
\( 01111101 \) resulting in 125 in the decimal system.
</div>


<p>

</section>


<section>

<h2>Loss of Precision  <a name="___sec36"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Machine Numbers.</b>
<p>
However, since the
exponent has eight bits, this means it has  \( 2^8-1=255 \) possible numbers in the interval
\( -128 \le m \le 127 \), our final
exponent is \( 125-127=-2 \) resulting in \( 2^{-2} \).
Inserting the sign and the mantissa yields the final number in the decimal representation as

<p>&nbsp;<br>
$$
 -2^{-2}\left(1\times 2^0+1\times 2^{-1}+
1\times 2^{-2}+1\times 2^{-3}+0\times 2^{-4}+1\times 2^{-5}\right)=$$
<p>&nbsp;<br>


<p>&nbsp;<br>
$$
(-0.4765625)_{10}.
$$
<p>&nbsp;<br>

In this case we have an exact machine representation with 32 bits (actually, we need less than
23 bits for the mantissa).

<p>
If our number \( x \) can be exactly represented in the machine, we call
\( x \) a machine number. Unfortunately, most numbers cannot  and are thereby
only approximated in the machine. When such a number occurs as the result
of reading some input data or of a computation, an inevitable error
will arise in representing it as accurately as possible by
a machine number.
</div>


<p>

</section>


<section>

<h2>Loss of Precision  <a name="___sec37"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Machine Numbers.</b>
<p>
A floating number x, labelled \( fl(x) \) will therefore always be represented as

<p>&nbsp;<br>
$$
\begin{equation}
  fl(x) = x(1\pm \epsilon_x),
\end{equation}
$$
<p>&nbsp;<br>

with \( x \) the exact number and the error \( |\epsilon_x| \le |\epsilon_M| \), where
\( \epsilon_M \) is the precision assigned. A number like \( 1/10 \) has no exact binary representation
with single or double precision. Since the mantissa

<p>&nbsp;<br>
$$
\left(1.a_{-1}a_{-2}\dots a_{-n}\right)_2
$$
<p>&nbsp;<br>

is always truncated at some stage \( n \) due to its limited number of bits, there is only a
limited number of real binary numbers. The spacing between every real binary number is given by the
chosen machine precision.
For a 32 bit words this number is approximately
$ \epsilon_M \sim 10^{-7}$ and for double precision (64 bits) we have
$ \epsilon_M \sim 10^{-16}$, or in terms of a binary base
as \( 2^{-23} \) and \( 2^{-52} \) for single and double precision, respectively.
</div>


<p>

</section>


<section>

<h2>Loss of Precision  <a name="___sec38"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Machine Numbers.</b>
<p>
In the machine a number is represented as

<p>&nbsp;<br>
$$
\begin{equation}
  fl(x)= x(1+\epsilon)
\end{equation}
$$
<p>&nbsp;<br>


<p>
where \( |\epsilon| \leq \epsilon_M \) and \( \epsilon \) is given by the
specified precision, \( 10^{-7} \) for single and \( 10^{-16} \) for double
precision, respectively.
\( \epsilon_M \) is the given precision.
In case of a subtraction \( a=b-c \), we have

<p>&nbsp;<br>
$$
\begin{equation}
   fl(a)=fl(b)-fl(c) = a(1+\epsilon_a),
\end{equation}
$$
<p>&nbsp;<br>

or

<p>&nbsp;<br>
$$
\begin{equation}
   fl(a)=b(1+\epsilon_b)-c(1+\epsilon_c),
\end{equation}
$$
<p>&nbsp;<br>


<p>
meaning that

<p>&nbsp;<br>
$$
\begin{equation}
   fl(a)/a=1+\epsilon_b\frac{b}{a}- \epsilon_c\frac{c}{a},
\end{equation}
$$
<p>&nbsp;<br>


<p>
and if \( b\approx c \) we see that there is a potential for an increased
error in \( fl(a) \).
</div>


<p>

</section>


<section>

<h2>Loss of Precision  <a name="___sec39"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Machine Numbers.</b>
<p>
Define
the absolute error as

<p>&nbsp;<br>
$$
\begin{equation}
   |fl(a)-a|,
\end{equation}
$$
<p>&nbsp;<br>

whereas the relative error is

<p>&nbsp;<br>
$$
\begin{equation}
   \frac{ |fl(a)-a|}{a} \le \epsilon_a.
\end{equation}
$$
<p>&nbsp;<br>

The above subraction is thus

<p>&nbsp;<br>
$$
\begin{equation}
   \frac{ |fl(a)-a|}{a}=\frac{ |fl(b)-fl(c)-(b-c)|}{a},
\end{equation}
$$
<p>&nbsp;<br>

yielding

<p>&nbsp;<br>
$$
\begin{equation}
   \frac{ |fl(a)-a|}{a}=\frac{ |b\epsilon_b- c\epsilon_c|}{a}.
\end{equation}
$$
<p>&nbsp;<br>

The relative error
is the quantity of interest in scientific work. Information about the
absolute error is normally of little use in the absence of the magnitude
of the quantity being measured.
</div>


<p>

</section>


<section>

<h2>Loss of numerical precision  <a name="___sec40"></a></h2>

Suppose we wish to evaluate the function

<p>&nbsp;<br>
$$
   f(x)=\frac{1-\cos(x)}{\sin(x)},
$$
<p>&nbsp;<br>

for small values of \( x \). Five leading digits. If we multiply the denominator and numerator
with \( 1+\cos(x) \) we obtain the equivalent expression

<p>&nbsp;<br>
$$
   f(x)=\frac{\sin(x)}{1+\cos(x)}.
$$
<p>&nbsp;<br>


<p>
If we now choose \( x=0.007 \) (in radians) our choice of precision results in

<p>&nbsp;<br>
$$
   \sin(0.007)\approx 0.69999\times 10^{-2},
$$
<p>&nbsp;<br>

and

<p>&nbsp;<br>
$$
   \cos(0.007)\approx 0.99998.
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Loss of numerical precision  <a name="___sec41"></a></h2>

The first expression for \( f(x) \) results in

<p>&nbsp;<br>
$$
   f(x)=\frac{1-0.99998}{0.69999\times 10^{-2}}=\frac{0.2\times 10^{-4}}{0.69999\times 10^{-2}}=0.28572\times 10^{-2},
$$
<p>&nbsp;<br>

while the second expression results in

<p>&nbsp;<br>
$$
   f(x)=\frac{0.69999\times 10^{-2}}{1+0.99998}=
\frac{0.69999\times 10^{-2}}{1.99998}=0.35000\times 10^{-2},
$$
<p>&nbsp;<br>

which is also the exact result. In the first expression, due to our
choice of precision, we have
only one relevant digit in the numerator, after the
subtraction. This leads to a loss of precision and a wrong result due to
a cancellation of two nearly equal numbers.
If we had chosen a precision of six leading digits, both expressions
yield the same answer.

<p>

</section>


<section>

<h2>Loss of numerical precision  <a name="___sec42"></a></h2>

If we were to evaluate \( x\sim \pi \), then the second expression for \( f(x) \)
can lead to potential losses of precision due to cancellations of nearly
equal numbers.

<p>
This simple example demonstrates  the loss of numerical precision due
to roundoff errors, where the number of leading digits is lost
in a subtraction of two near equal numbers.
The lesson to be drawn is that we cannot blindly compute a function.
We will always need to carefully analyze our algorithm in the search for
potential pitfalls. There is no magic recipe however, the only guideline
is an understanding of the fact that a machine cannot represent
correctly <em>all</em> numbers.

<p>

</section>


<section>

<h2>Loss of precision can cuae serious problems  <a name="___sec43"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Real Numbers.</b>
<p>

<ul>
  <p><li> <b>Overflow</b>: When the positive exponent exceeds the max value, e.g., 308 for <code>DOUBLE PRECISION</code> (64 bits). Under such circumstances the program will terminate and some compilers may give you the warning <code>OVERFLOW</code>.</li>
  <p><li> <b>Underflow</b>: When the negative exponent becomes smaller than the min value, e.g., -308 for <code>DOUBLE PRECISION</code>. Normally, the variable is then set to zero and the program continues. Other compilers (or compiler options) may warn you with the <code>UNDERFLOW</code> message and the program terminates.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Loss of precision, real numbers  <a name="___sec44"></a></h2>

<h3>Roundoff errors  <a name="___sec45"></a></h3>

A floating point number like

<p>&nbsp;<br>
$$
\begin{equation}
   x= 1.234567891112131468 = 0.1234567891112131468\times 10^{1}
\end{equation}
$$
<p>&nbsp;<br>

may be stored in the following way. The exponent is  small
and is stored in full precision. However,
the mantissa is not stored fully. In double precision (64 bits), digits
beyond the
15th are lost since the mantissa is normally stored in two words,
one which is the most significant one representing
123456 and the least significant one containing 789111213. The digits
beyond 3 are lost. Clearly, if we are summing alternating series
with large numbers, subtractions between two large numbers may lead
to roundoff errors, since not all relevant digits are kept.
This leads eventually to the next problem, namely

<p>

</section>


<section>

<h2>More on loss of precision  <a name="___sec46"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Real Numbers.</b>
<p>

<ul>
  <p><li> <b>Loss of precision</b>: When one has to e.g., multiply two large numbers where one suspects that the outcome may be beyond the bonds imposed by the variable declaration, one could represent the numbers by logarithms, or rewrite the equations to be solved in terms of dimensionless variables. When dealing with problems in e.g., particle physics or nuclear physics where distance is measured in fm (\( 10^{-15} \) m), it can be quite convenient to redefine the variables for distance in terms of a dimensionless variable of the order of unity. To give an example, suppose you work with single precision and wish to perform the addition \( 1+10^{-8} \). In this case, the information containing in \( 10^{-8} \) is simply lost in the addition. Typically, when performing the addition, the computer equates first the exponents of the two numbers to be added. For \( 10^{-8} \) this has however catastrophic consequences since in order to obtain an exponent equal to \( 10^0 \), bits in the mantissa are shifted to the right. At the end, all bits in the mantissa are zeros.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>A problematic case  <a name="___sec47"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Three ways of computing \( e^{-x} \).</b>
<p>
Brute force:

<p>&nbsp;<br>
$$\exp{(-x)}=\sum_{n=0}^{\infty}(-1)^n\frac{x^n}{n!}$$
<p>&nbsp;<br>


<p>
Recursion relation for

<p>&nbsp;<br>
$$ \exp{(-x)}=\sum_{n=0}^{\infty}s_n=\sum_{n=0}^{\infty}(-1)^n\frac{x^n}{n!} $$
<p>&nbsp;<br>


<p>&nbsp;<br>
$$ s_n=-s_{n-1}\frac{x}{n}, $$
<p>&nbsp;<br>


<p>&nbsp;<br>
$$ \exp{(x)}=\sum_{n=0}^{\infty}s_n $$
<p>&nbsp;<br>


<p>&nbsp;<br>
$$ \exp{(-x)}=\frac{1}{\exp{(x)}} $$
<p>&nbsp;<br>
</div>


<p>

</section>


<section>

<h2>Program to compute \( \exp{(-x)} \)  <a name="___sec48"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Brute Force.</b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">// Program to calculate function exp(-x)</span>
<span style="color: #999999; font-style: italic">// using straightforward summation with differing  precision</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;cmath&gt;</span>
<span style="color: #999999; font-style: italic">// type float:  32 bits precision</span>
<span style="color: #999999; font-style: italic">// type double: 64 bits precision</span>
<span style="color: #cd2828; font-weight: bold">#define   TYPE          double</span>
<span style="color: #cd2828; font-weight: bold">#define   PHASE(a)      (1 - 2 * (abs(a) % 2))</span>
<span style="color: #cd2828; font-weight: bold">#define   TRUNCATION    1.0E-10</span>
<span style="color: #999999; font-style: italic">// function declaration</span>
<span style="color: #d0d0d0">TYPE</span> <span style="color: #d0d0d0">factorial(</span><span style="color: #6ab825; font-weight: bold">int</span><span style="color: #d0d0d0">);</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Program to compute \( \exp{(-x)} \)  <a name="___sec49"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Still Brute Force.</b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">()</span>
<span style="color: #d0d0d0">{</span>
   <span style="color: #6ab825; font-weight: bold">int</span>   <span style="color: #d0d0d0">n;</span>
   <span style="color: #d0d0d0">TYPE</span>  <span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">term,</span> <span style="color: #d0d0d0">sum;</span>
   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(x</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #3677a9">100.0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">+=</span> <span style="color: #3677a9">10.0</span><span style="color: #d0d0d0">)</span>  <span style="color: #d0d0d0">{</span>
     <span style="color: #d0d0d0">sum</span>  <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.0</span><span style="color: #d0d0d0">;</span>                <span style="color: #999999; font-style: italic">//initialization</span>
     <span style="color: #d0d0d0">n</span>    <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
     <span style="color: #d0d0d0">term</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">;</span>
     <span style="color: #6ab825; font-weight: bold">while</span><span style="color: #d0d0d0">(fabs(term)</span> <span style="color: #d0d0d0">&gt;</span> <span style="color: #d0d0d0">TRUNCATION)</span>  <span style="color: #d0d0d0">{</span>
         <span style="color: #d0d0d0">term</span> <span style="color: #d0d0d0">=</span>  <span style="color: #d0d0d0">PHASE(n)</span> <span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">(TYPE)</span> <span style="color: #d0d0d0">pow((TYPE)</span> <span style="color: #d0d0d0">x,(TYPE)</span> <span style="color: #d0d0d0">n)</span>
                <span style="color: #d0d0d0">/</span> <span style="color: #d0d0d0">factorial(n);</span>
         <span style="color: #d0d0d0">sum</span> <span style="color: #d0d0d0">+=</span> <span style="color: #d0d0d0">term;</span>
         <span style="color: #d0d0d0">n++;</span>
     <span style="color: #d0d0d0">}</span>  <span style="color: #999999; font-style: italic">// end of while() loop</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Program to compute \( \exp{(-x)} \)  <a name="___sec50"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Oh, it never ends!</b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">      <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nx = %4.1f   exp = %12.5E  series = %12.5E</span>
              <span style="color: #d0d0d0">number</span> <span style="color: #d0d0d0">of</span> <span style="color: #d0d0d0">terms</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">%d</span><span style="color: #ed9d13">&quot;,</span>
              <span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">exp(-x),</span> <span style="color: #d0d0d0">sum,</span> <span style="color: #d0d0d0">n);</span>
   <span style="color: #d0d0d0">}</span> <span style="color: #999999; font-style: italic">// end of for() loop</span>

   <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">);</span>           <span style="color: #999999; font-style: italic">// a final line shift on output</span>
   <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">}</span> <span style="color: #999999; font-style: italic">// End: function main()</span>
<span style="color: #999999; font-style: italic">//     The function factorial()</span>
<span style="color: #999999; font-style: italic">//     calculates and returns n!</span>
<span style="color: #d0d0d0">TYPE</span> <span style="color: #d0d0d0">factorial(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">n)</span>
<span style="color: #d0d0d0">{</span>
   <span style="color: #6ab825; font-weight: bold">int</span>  <span style="color: #d0d0d0">loop;</span>
   <span style="color: #d0d0d0">TYPE</span> <span style="color: #d0d0d0">fac;</span>
   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(loop</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">fac</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1.0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">loop</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">loop++)</span>  <span style="color: #d0d0d0">{</span>
      <span style="color: #d0d0d0">fac</span> <span style="color: #d0d0d0">*=</span> <span style="color: #d0d0d0">loop;</span>

   <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">fac;</span>
<span style="color: #d0d0d0">}</span> <span style="color: #999999; font-style: italic">// End: function factorial()</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Results \( \exp{(-x)} \)  <a name="___sec51"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>What is going on?</b>
<p>

<p>
<table border="1">
<thead>
<tr><td align="center">         \( x \)         </td> <td align="center">     \( \exp{(-x)} \)    </td> <th align="center">          Series         </th> <th align="center">Number of terms in series</th> </tr>
</thead>
<tbody>
<tr><td align="center">   0.0                          </td> <td align="center">   0.100000E+01                 </td> <td align="center">   0.100000E+01                 </td> <td align="center">   1                            </td> </tr>
<tr><td align="center">   10.0                         </td> <td align="center">   0.453999E-04                 </td> <td align="center">   0.453999E-04                 </td> <td align="center">   44                           </td> </tr>
<tr><td align="center">   20.0                         </td> <td align="center">   0.206115E-08                 </td> <td align="center">   0.487460E-08                 </td> <td align="center">   72                           </td> </tr>
<tr><td align="center">   30.0                         </td> <td align="center">   0.935762E-13                 </td> <td align="center">   -0.342134E-04                </td> <td align="center">   100                          </td> </tr>
<tr><td align="center">   40.0                         </td> <td align="center">   0.424835E-17                 </td> <td align="center">   -0.221033E+01                </td> <td align="center">   127                          </td> </tr>
<tr><td align="center">   50.0                         </td> <td align="center">   0.192875E-21                 </td> <td align="center">   -0.833851E+05                </td> <td align="center">   155                          </td> </tr>
<tr><td align="center">   60.0                         </td> <td align="center">   0.875651E-26                 </td> <td align="center">   -0.850381E+09                </td> <td align="center">   171                          </td> </tr>
<tr><td align="center">   70.0                         </td> <td align="center">   0.397545E-30                 </td> <td align="center">   NaN                          </td> <td align="center">   171                          </td> </tr>
<tr><td align="center">   80.0                         </td> <td align="center">   0.180485E-34                 </td> <td align="center">   NaN                          </td> <td align="center">   171                          </td> </tr>
<tr><td align="center">   90.0                         </td> <td align="center">   0.819401E-39                 </td> <td align="center">   NaN                          </td> <td align="center">   171                          </td> </tr>
<tr><td align="center">   100.0                        </td> <td align="center">   0.372008E-43                 </td> <td align="center">   NaN                          </td> <td align="center">   171                          </td> </tr>
</tbody>
</table>

</div>


<p>

</section>


<section>

<h2>Program to compute \( \exp{(-x)} \)  <a name="___sec52"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">// program to compute exp(-x) without exponentials</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;cmath&gt;</span>
<span style="color: #cd2828; font-weight: bold">#define  TRUNCATION     1.0E-10</span>

<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">main()</span>
<span style="color: #d0d0d0">{</span>
   <span style="color: #6ab825; font-weight: bold">int</span>       <span style="color: #d0d0d0">loop,</span> <span style="color: #d0d0d0">n;</span>
   <span style="color: #6ab825; font-weight: bold">double</span>    <span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">term,</span> <span style="color: #d0d0d0">sum;</span>
   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(loop</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">loop</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #3677a9">100</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">loop</span> <span style="color: #d0d0d0">+=</span> <span style="color: #3677a9">10</span><span style="color: #d0d0d0">)</span>
   <span style="color: #d0d0d0">{</span>
     <span style="color: #d0d0d0">x</span>    <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">loop;</span>          <span style="color: #999999; font-style: italic">// initialization</span>
     <span style="color: #d0d0d0">sum</span>  <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1.0</span><span style="color: #d0d0d0">;</span>
     <span style="color: #d0d0d0">term</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">;</span>
     <span style="color: #d0d0d0">n</span>    <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">;</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Program to compute \( \exp{(-x)} \)  <a name="___sec53"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Last statements.</b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">     <span style="color: #6ab825; font-weight: bold">while</span><span style="color: #d0d0d0">(fabs(term)</span> <span style="color: #d0d0d0">&gt;</span> <span style="color: #d0d0d0">TRUNCATION)</span>
       <span style="color: #d0d0d0">{</span>
	 <span style="color: #d0d0d0">term</span> <span style="color: #d0d0d0">*=</span> <span style="color: #d0d0d0">-x/((</span><span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">n);</span>
	 <span style="color: #d0d0d0">sum</span>  <span style="color: #d0d0d0">+=</span> <span style="color: #d0d0d0">term;</span>
	 <span style="color: #d0d0d0">n++;</span>
       <span style="color: #d0d0d0">}</span> <span style="color: #999999; font-style: italic">// end while loop</span>
     <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;x = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">x</span>   <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot; exp = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">exp(-x)</span> <span style="color: #d0d0d0">&lt;&lt;</span><span style="color: #ed9d13">&quot;series = &quot;</span>
          <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">sum</span>  <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot; number of terms =&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>
   <span style="color: #d0d0d0">}</span> <span style="color: #999999; font-style: italic">// end of for() loop</span>

   <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>           <span style="color: #999999; font-style: italic">// a final line shift on output</span>

<span style="color: #d0d0d0">}</span>  <span style="color: #999999; font-style: italic">/*    End: function main() */</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Results \( \exp{(-x)} \)  <a name="___sec54"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>More Problems.</b>
<p>

<p>
<table border="1">
<thead>
<tr><td align="center">         \( x \)         </td> <td align="center">     \( \exp{(-x)} \)    </td> <th align="center">          Series         </th> <th align="center">Number of terms in series</th> </tr>
</thead>
<tbody>
<tr><td align="center">   0.000000                     </td> <td align="center">   0.10000000E+01               </td> <td align="center">   0.10000000E+01               </td> <td align="center">   1                            </td> </tr>
<tr><td align="center">   10.000000                    </td> <td align="center">   0.45399900E-04               </td> <td align="center">   0.45399900E-04               </td> <td align="center">   44                           </td> </tr>
<tr><td align="center">   20.000000                    </td> <td align="center">   0.20611536E-08               </td> <td align="center">   0.56385075E-08               </td> <td align="center">   72                           </td> </tr>
<tr><td align="center">   30.000000                    </td> <td align="center">   0.93576230E-13               </td> <td align="center">   -0.30668111E-04              </td> <td align="center">   100                          </td> </tr>
<tr><td align="center">   40.000000                    </td> <td align="center">   0.42483543E-17               </td> <td align="center">   -0.31657319E+01              </td> <td align="center">   127                          </td> </tr>
<tr><td align="center">   50.000000                    </td> <td align="center">   0.19287498E-21               </td> <td align="center">   0.11072933E+05               </td> <td align="center">   155                          </td> </tr>
<tr><td align="center">   60.000000                    </td> <td align="center">   0.87565108E-26               </td> <td align="center">   -0.33516811E+09              </td> <td align="center">   182                          </td> </tr>
<tr><td align="center">   70.000000                    </td> <td align="center">   0.39754497E-30               </td> <td align="center">   -0.32979605E+14              </td> <td align="center">   209                          </td> </tr>
<tr><td align="center">   80.000000                    </td> <td align="center">   0.18048514E-34               </td> <td align="center">   0.91805682E+17               </td> <td align="center">   237                          </td> </tr>
<tr><td align="center">   90.000000                    </td> <td align="center">   0.81940126E-39               </td> <td align="center">   -0.50516254E+22              </td> <td align="center">   264                          </td> </tr>
<tr><td align="center">   100.000000                   </td> <td align="center">   0.37200760E-43               </td> <td align="center">   -0.29137556E+26              </td> <td align="center">   291                          </td> </tr>
</tbody>
</table>

</div>


<p>

</section>


<section>

<h2>Most used formula for derivatives  <a name="___sec55"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>3 point formulae.</b>
<p>
First derivative  (\( f_0 = f(x_0) \), \( f_{-h}=f(x_0-h) \) and \( f_{+h}=f(x_0+h) \)

<p>&nbsp;<br>
$$
   \frac{f_h-f_{-h}}{2h}=f'_0+\sum_{j=1}^{\infty}\frac{f_0^{(2j+1)}}{(2j+1)!}h^{2j}.
$$
<p>&nbsp;<br>

Second derivative

<p>&nbsp;<br>
$$
 \frac{ f_h -2f_0 +f_{-h}}{h^2}=f_0''+2\sum_{j=1}^{\infty}\frac{f_0^{(2j+2)}}{(2j+2)!}h^{2j}.
$$
<p>&nbsp;<br>
</div>


<p>

</section>


<section>

<h2>Error Analysis  <a name="___sec56"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>&nbsp;<br>
$$
   \epsilon=log_{10}\left(\left|\frac{f''_{\mbox{computed}}-f''_{\mbox{exact}}}
                 {f''_{\mbox{exact}}}\right|\right),
$$
<p>&nbsp;<br>


<p>&nbsp;<br>
$$
   \epsilon_{\mbox{tot}}=\epsilon_{\mbox{approx}}+\epsilon_{\mbox{ro}}.
$$
<p>&nbsp;<br>


<p>
For the computed second derivative  we have

<p>&nbsp;<br>
$$
 f_0''=\frac{ f_h -2f_0 +f_{-h}}{h^2}-2\sum_{j=1}^{\infty}\frac{f_0^{(2j+2)}}{(2j+2)!}h^{2j},
$$
<p>&nbsp;<br>

and the truncation or approximation error goes like

<p>&nbsp;<br>
$$
  \epsilon_{\mbox{approx}}\approx \frac{f_0^{(4)}}{12}h^{2}.
$$
<p>&nbsp;<br>
</div>


<p>

</section>


<section>

<h2>Error Analysis  <a name="___sec57"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
If we were not to worry about loss of precision, we could in principle
make \( h \) as small as possible.
However, due to the computed expression in the above program example

<p>&nbsp;<br>
$$
 f_0''=\frac{ f_h -2f_0 +f_{-h}}{h^2}=\frac{ (f_h -f_0) +(f_{-h}-f_0)}{h^2},
$$
<p>&nbsp;<br>

we reach fairly quickly a limit for where loss of precision due to the subtraction
of two nearly equal numbers becomes crucial.

<p>
If \( (f_{\pm h} -f_0) \) are very close, we have
\( (f_{\pm h} -f_0)\approx \epsilon_M \), where \( |\epsilon_M|\le 10^{-7} \) for single and
\( |\epsilon_M|\le 10^{-15} \) for double precision, respectively.

<p>
We have then

<p>&nbsp;<br>
$$
 \left|f_0''\right|=
 \left|\frac{ (f_h -f_0) +(f_{-h}-f_0)}{h^2}\right|\le \frac{ 2 \epsilon_M}{h^2}.
$$
<p>&nbsp;<br>
</div>


<p>

</section>


<section>

<h2>Error Analysis  <a name="___sec58"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Our total error becomes

<p>&nbsp;<br>
$$
   \left|\epsilon_{\mbox{tot}}\right|\le  \frac{2 \epsilon_M}{h^2} +
                          \frac{f_0^{(4)}}{12}h^{2}.
    \tag{1}
$$
<p>&nbsp;<br>

It is then natural to ask which value of \( h \) yields the smallest
total error. Taking the derivative of \( \left|\epsilon_{\mbox{tot}}\right| \)
with respect to \( h \) results in

<p>&nbsp;<br>
$$
   h= \left(\frac{ 24\epsilon_M}{f_0^{(4)}}\right)^{1/4}.
$$
<p>&nbsp;<br>

With double precision and \( x=10 \) we obtain

<p>&nbsp;<br>
$$
   h\approx 10^{-4}.
$$
<p>&nbsp;<br>

Beyond this value, it is essentially the loss of numerical precision
which takes over.
</div>


<p>

</section>


<section>

<h2>Error Analysis  <a name="___sec59"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Due to the subtractive cancellation in the expression
for \( f'' \) there is a pronounced detoriation in accuracy as \( h \) is made smaller
and smaller.

<p>
It is instructive in this analysis to rewrite the numerator of
the computed derivative as

<p>&nbsp;<br>
$$
   (f_h -f_0) +(f_{-h}-f_0)=(e^{x+h}-e^{x}) + (e^{x-h}-e^{x}),
$$
<p>&nbsp;<br>

as

<p>&nbsp;<br>
$$
   (f_h -f_0) +(f_{-h}-f_0)=e^x(e^{h}+e^{-h}-2),
$$
<p>&nbsp;<br>

since it is the difference \( (e^{h}+e^{-h}-2) \) which causes
the loss of precision.
</div>


<p>

</section>


<section>

<h2>Error Analysis  <a name="___sec60"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
<table border="1">
<thead>
<tr><td align="center">     \( x \)     </td> <td align="center">   \( h=0.01 \)  </td> <td align="center">  \( h=0.001 \)  </td> <td align="center">  \( h=0.0001 \) </td> <td align="center">\( h=0.0000001 \)</td> <th align="center">      Exact      </th> </tr>
</thead>
<tbody>
<tr><td align="center">   0.0                  </td> <td align="center">   1.000008             </td> <td align="center">   1.000000             </td> <td align="center">   1.000000             </td> <td align="center">   1.010303             </td> <td align="center">   1.000000             </td> </tr>
<tr><td align="center">   1.0                  </td> <td align="center">   2.718304             </td> <td align="center">   2.718282             </td> <td align="center">   2.718282             </td> <td align="center">   2.753353             </td> <td align="center">   2.718282             </td> </tr>
<tr><td align="center">   2.0                  </td> <td align="center">   7.389118             </td> <td align="center">   7.389057             </td> <td align="center">   7.389056             </td> <td align="center">   7.283063             </td> <td align="center">   7.389056             </td> </tr>
<tr><td align="center">   3.0                  </td> <td align="center">   20.085704            </td> <td align="center">   20.085539            </td> <td align="center">   20.085537            </td> <td align="center">   20.250467            </td> <td align="center">   20.085537            </td> </tr>
<tr><td align="center">   4.0                  </td> <td align="center">   54.598605            </td> <td align="center">   54.598155            </td> <td align="center">   54.598151            </td> <td align="center">   54.711789            </td> <td align="center">   54.598150            </td> </tr>
<tr><td align="center">   5.0                  </td> <td align="center">   148.414396           </td> <td align="center">   148.413172           </td> <td align="center">   148.413161           </td> <td align="center">   150.635056           </td> <td align="center">   148.413159           </td> </tr>
</tbody>
</table>

</div>


<p>

</section>


<section>

<h2>Error Analysis  <a name="___sec61"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The results for \( x=10 \) are shown in the Table

<p>
<table border="1">
<thead>
<tr><td align="center">                \( h \)                </td> <td align="center">           \( e^{h}+e^{-h} \)          </td> <td align="center">          \( e^{h}+e^{-h}-2 \)         </td> </tr>
</thead>
<tbody>
<tr><td align="center">   \( 10^{-1} \)                              </td> <td align="center">   2.0100083361116070                         </td> <td align="center">   \( 1.0008336111607230\times 10^{-2} \)     </td> </tr>
<tr><td align="center">   \( 10^{-2} \)                              </td> <td align="center">   2.0001000008333358                         </td> <td align="center">   \( 1.0000083333605581\times 10^{-4} \)     </td> </tr>
<tr><td align="center">   \( 10^{-3} \)                              </td> <td align="center">   2.0000010000000836                         </td> <td align="center">   \( 1.0000000834065048\times 10^{-6} \)     </td> </tr>
<tr><td align="center">   \( 10^{-5} \)                              </td> <td align="center">   2.0000000099999999                         </td> <td align="center">   \( 1.0000000050247593\times 10^{-8} \)     </td> </tr>
<tr><td align="center">   \( 10^{-5} \)                              </td> <td align="center">   2.0000000001000000                         </td> <td align="center">   \( 9.9999897251734637\times 10^{-11} \)    </td> </tr>
<tr><td align="center">   \( 10^{-6} \)                              </td> <td align="center">   2.0000000000010001                         </td> <td align="center">   \( 9.9997787827987850\times 10^{-13} \)    </td> </tr>
<tr><td align="center">   \( 10^{-7} \)                              </td> <td align="center">   2.0000000000000098                         </td> <td align="center">   \( 9.9920072216264089\times 10^{-15} \)    </td> </tr>
<tr><td align="center">   \( 10^{-8} \)                              </td> <td align="center">   2.0000000000000000                         </td> <td align="center">   \( 0.0000000000000000\times 10^{0} \)      </td> </tr>
<tr><td align="center">   \( 10^{-9} \)                              </td> <td align="center">   2.0000000000000000                         </td> <td align="center">   \( 1.1102230246251565\times 10^{-16} \)    </td> </tr>
<tr><td align="center">   \( 10^{-10} \)                             </td> <td align="center">   2.0000000000000000                         </td> <td align="center">   \( 0.0000000000000000\times 10^{0} \)      </td> </tr>
</tbody>
</table>

</div>


<h1>Week 35  <a name="___sec62"></a></h1>


</section>


<section>

<h2>Overview of week 35  <a name="___sec63"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <p><li> Monday: Repetition from last week</li>
  <p><li> Numerical differentiation</li>
  <p><li> C/C++ programming details, pointers, read/write to/from file</li>
  <p><li> Tuesday: Intro to linear Algebra and presentation of project 1.</li>
  <p><li> Matrices in C++ and Fortran2008</li>
  <p><li> Gaussian elimination and discussion of project 1.</li>
  <p><li> Computer-Lab: start project 1. Reading asssignments and preparation for project 1: sections 2.5 and 3.1 for general C++ and Fortran features. Sections 6.1-6.4 (till page 182) are relevant for project 1.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Technical Matter in C/C++: Pointers  <a name="___sec64"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
A pointer specifies where a value resides in the computer's memory (like a house number specifies where a particular family resides on a street).

<p>
A pointer points to an address not to a data container of any kind!

<p>
Simple example declarations:

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span> <span style="color: #999999; font-style: italic">// note use of namespace</span>
  <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">()</span>
 <span style="color: #d0d0d0">{</span>
   <span style="color: #999999; font-style: italic">// what are the differences?</span>
   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">var;</span>
   <span style="color: #d0d0d0">cin</span> <span style="color: #d0d0d0">&gt;&gt;</span> <span style="color: #d0d0d0">var;</span>
   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*p,</span> <span style="color: #d0d0d0">q;</span>
   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*s,</span> <span style="color: #d0d0d0">*t;</span>
   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">a</span> <span style="color: #6ab825; font-weight: bold">new</span><span style="color: #d0d0d0">[var];</span>    <span style="color: #999999; font-style: italic">// dynamic memory allocation</span>
   <span style="color: #6ab825; font-weight: bold">delete</span> <span style="color: #d0d0d0">[]</span> <span style="color: #d0d0d0">a;</span>
<span style="color: #d0d0d0">}</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Technical Matter in C/C++: Pointer example I  <a name="___sec65"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span> <span style="color: #999999; font-style: italic">// note use of namespace</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">()</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">var;</span>
  <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*p;</span>
  <span style="color: #d0d0d0">p</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">&amp;var;</span>
  <span style="color: #d0d0d0">var</span>  <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">421</span><span style="color: #d0d0d0">;</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Address of integer variable var : %p\n&quot;</span><span style="color: #d0d0d0">,&amp;var);</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Its value: %d\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">var);</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Value of integer pointer p : %p\n&quot;</span><span style="color: #d0d0d0">,p);</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;The value p points at :  %d\n&quot;</span><span style="color: #d0d0d0">,*p);</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Address of the pointer p : %p\n&quot;</span><span style="color: #d0d0d0">,&amp;p);</span>
  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">}</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Dissection: Pointer example I  <a name="___sec66"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Discussion.</b>
<p>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">()</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">var;</span>     <span style="color: #999999; font-style: italic">// Define an integer variable var</span>
  <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*p;</span>      <span style="color: #999999; font-style: italic">// Define a pointer to an integer</span>
  <span style="color: #d0d0d0">p</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">&amp;var;</span>    <span style="color: #999999; font-style: italic">// Extract the address of var</span>
  <span style="color: #d0d0d0">var</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">421</span><span style="color: #d0d0d0">;</span>   <span style="color: #999999; font-style: italic">// Change content of var</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Address of integer variable var : %p\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">&amp;var);</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Its value: %d\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">var);</span>  <span style="color: #999999; font-style: italic">// 421</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Value of integer pointer p : %p\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">p);</span>  <span style="color: #999999; font-style: italic">// = &amp;var</span>
  <span style="color: #999999; font-style: italic">// The content of the variable pointed to by p is *p</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;The value p points at :  %d\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">*p);</span>
  <span style="color: #999999; font-style: italic">// Address where the pointer is stored in memory</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Address of the pointer p : %p\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">&amp;p);</span>
  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">}</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Pointer example II  <a name="___sec67"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">];</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*p;</span>
<span style="color: #d0d0d0">p</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">&amp;matr[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">];</span>
<span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">321</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">322</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nAddress of matrix element matr[1]: %p&quot;</span><span style="color: #d0d0d0">,&amp;matr[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nValue of the  matrix element  matr[1]; %d&quot;</span><span style="color: #d0d0d0">,matr[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nAddress of matrix element matr[2]: %p&quot;</span><span style="color: #d0d0d0">,&amp;matr[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nValue of the matrix element  matr[2]: %d\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nValue of the pointer p: %p&quot;</span><span style="color: #d0d0d0">,p);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nThe value p points to: %d&quot;</span><span style="color: #d0d0d0">,*p);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nThe value that (p+1) points to  %d\n&quot;</span><span style="color: #d0d0d0">,*(p+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">));</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nAddress of pointer p : %p\n&quot;</span><span style="color: #d0d0d0">,&amp;p);</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Dissection: Pointer example II  <a name="___sec68"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">];</span>    <span style="color: #999999; font-style: italic">// Define integer array with two elements</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*p;</span>         <span style="color: #999999; font-style: italic">// Define pointer to integer</span>
<span style="color: #d0d0d0">p</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">&amp;matr[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">];</span>   <span style="color: #999999; font-style: italic">// Point to the address of the first element in matr</span>
<span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">321</span><span style="color: #d0d0d0">;</span>  <span style="color: #999999; font-style: italic">// Change the first element</span>
<span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">322</span><span style="color: #d0d0d0">;</span>  <span style="color: #999999; font-style: italic">// Change the second element</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nAddress of matrix element matr[1]: %p&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">&amp;matr[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nValue of the  matrix element  matr[1]; %d&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nAddress of matrix element matr[2]: %p&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">&amp;matr[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nValue of the matrix element  matr[2]: %d\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">matr[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nValue of the pointer p: %p&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">p);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nThe value p points to: %d&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">*p);</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nThe value that (p+1) points to  %d\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">*(p+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">));</span>
<span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\nAddress of pointer p : %p\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">&amp;p);</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Output of Pointer example II  <a name="___sec69"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=text typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">Address of the matrix element matr[1]: 0xbfffef70
Value of the  matrix element  matr[1]; 321
Address of the matrix element matr[2]: 0xbfffef74
Value of the matrix element  matr[2]: 322
Value of the pointer: 0xbfffef70
The value pointer points at: 321
The value that (pointer+1) points at:  322
Address of the pointer variable : 0xbfffef6c
</pre></div>

</div>


<p>

</section>


<section>

<h2>File handling; C-way  <a name="___sec70"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span> <span style="color: #d0d0d0">*argv[])</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">FILE</span> <span style="color: #d0d0d0">*in_file,</span> <span style="color: #d0d0d0">*out_file;</span>
  <span style="color: #6ab825; font-weight: bold">if</span><span style="color: #d0d0d0">(</span> <span style="color: #d0d0d0">argc</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #3677a9">3</span><span style="color: #d0d0d0">)</span>  <span style="color: #d0d0d0">{</span>
    <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;The programs has the following structure :\n&quot;</span><span style="color: #d0d0d0">);</span>
    <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;write in the name of the input and output files \n&quot;</span><span style="color: #d0d0d0">);</span>
    <span style="color: #d0d0d0">exit(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">}</span>
  <span style="color: #d0d0d0">in_file</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">fopen(</span> <span style="color: #d0d0d0">argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">],</span> <span style="color: #ed9d13">&quot;r&quot;</span><span style="color: #d0d0d0">);</span><span style="color: #999999; font-style: italic">// returns pointer to the  input file</span>
  <span style="color: #6ab825; font-weight: bold">if</span><span style="color: #d0d0d0">(</span> <span style="color: #d0d0d0">in_file</span> <span style="color: #d0d0d0">==</span> <span style="color: #24909d">NULL</span> <span style="color: #d0d0d0">)</span>  <span style="color: #d0d0d0">{</span> <span style="color: #999999; font-style: italic">// NULL means that the file is missing</span>
    <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Can&#39;t find the input file %s\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]);</span>
    <span style="color: #d0d0d0">exit(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">);</span>
</pre></div>
<p>

</section>


<section>

<h2>File handling; C way cont.  <a name="___sec71"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"> <span style="color: #d0d0d0">out_file</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">fopen(</span> <span style="color: #d0d0d0">argv[</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">],</span> <span style="color: #ed9d13">&quot;w&quot;</span><span style="color: #d0d0d0">);</span> <span style="color: #999999; font-style: italic">// returns a pointer to the output file</span>
 <span style="color: #6ab825; font-weight: bold">if</span><span style="color: #d0d0d0">(</span> <span style="color: #d0d0d0">out_file</span> <span style="color: #d0d0d0">==</span> <span style="color: #24909d">NULL</span> <span style="color: #d0d0d0">)</span>  <span style="color: #d0d0d0">{</span>       <span style="color: #999999; font-style: italic">// can&#39;t find the file</span>
    <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;Can&#39;t find the output file%s\n&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">argv[</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">]);</span>
    <span style="color: #d0d0d0">exit(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">}</span>
  <span style="color: #d0d0d0">fclose(in_file);</span>
  <span style="color: #d0d0d0">fclose(out_file);</span>
  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
</pre></div>
<p>

</section>


<section>

<h2>File handling, C++-way  <a name="___sec72"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #cd2828; font-weight: bold">#include &lt;fstream&gt;</span>

<span style="color: #999999; font-style: italic">// input and output file as global variable</span>
<span style="color: #d0d0d0">ofstream</span> <span style="color: #d0d0d0">ofile;</span>
<span style="color: #d0d0d0">ifstream</span> <span style="color: #d0d0d0">ifile;</span>
</pre></div>
<p>

</section>


<section>

<h2>File handling, C++-way  <a name="___sec73"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">argv[])</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">char</span> <span style="color: #d0d0d0">*outfilename;</span>
  <span style="color: #999999; font-style: italic">//Read in output file, abort if there are too</span>
  <span style="color: #999999; font-style: italic">//few command-line arguments</span>
  <span style="color: #6ab825; font-weight: bold">if</span><span style="color: #d0d0d0">(</span> <span style="color: #d0d0d0">argc</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #3677a9">1</span> <span style="color: #d0d0d0">){</span>
    <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Bad Usage: &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">argv[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">&lt;&lt;</span>
      <span style="color: #ed9d13">&quot; read also output file on same line&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
    <span style="color: #d0d0d0">exit(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">}</span>
  <span style="color: #6ab825; font-weight: bold">else</span><span style="color: #d0d0d0">{</span>
    <span style="color: #d0d0d0">outfilename=argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">];</span>
  <span style="color: #d0d0d0">}</span>
  <span style="color: #d0d0d0">ofile.open(outfilename);</span>
  <span style="color: #d0d0d0">.....</span>
  <span style="color: #d0d0d0">ofile.close();</span>  <span style="color: #999999; font-style: italic">// close output file</span>
</pre></div>
<p>

</section>


<section>

<h2>File handling, C++-way  <a name="___sec74"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">void</span> <span style="color: #447fcf">output</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">r_min</span> <span style="color: #d0d0d0">,</span> <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">r_max,</span> <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">max_step,</span>
            <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">*d)</span>
<span style="color: #d0d0d0">{</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">i;</span>
<span style="color: #d0d0d0">ofile</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;RESULTS:&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
<span style="color: #d0d0d0">ofile</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">setiosflags(ios::showpoint</span> <span style="color: #d0d0d0">|</span> <span style="color: #d0d0d0">ios::uppercase);</span>
<span style="color: #d0d0d0">ofile</span> <span style="color: #d0d0d0">&lt;&lt;</span><span style="color: #ed9d13">&quot;R_min = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">setw(</span><span style="color: #3677a9">15</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">setprecision(</span><span style="color: #3677a9">8</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;r_min</span> <span style="color: #d0d0d0">&lt;&lt;endl;</span>
<span style="color: #d0d0d0">ofile</span> <span style="color: #d0d0d0">&lt;&lt;</span><span style="color: #ed9d13">&quot;R_max = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">setw(</span><span style="color: #3677a9">15</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">setprecision(</span><span style="color: #3677a9">8</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;r_max</span> <span style="color: #d0d0d0">&lt;&lt;endl;</span>
<span style="color: #d0d0d0">ofile</span> <span style="color: #d0d0d0">&lt;&lt;</span><span style="color: #ed9d13">&quot;Number of steps = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">setw(</span><span style="color: #3677a9">15</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">max_step</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
<span style="color: #d0d0d0">ofile</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Five lowest eigenvalues:&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
<span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #3677a9">5</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
    <span style="color: #d0d0d0">ofile</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">setw(</span><span style="color: #3677a9">15</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">setprecision(</span><span style="color: #3677a9">8</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">d[i]</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>

<span style="color: #d0d0d0">}</span>  <span style="color: #999999; font-style: italic">// end of function output</span>
</pre></div>
<p>

</section>


<section>

<h2>File handling, C++-way  <a name="___sec75"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">argv[])</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">char</span> <span style="color: #d0d0d0">*infilename;</span>
  <span style="color: #999999; font-style: italic">// Read in input file, abort if there are too</span>
  <span style="color: #999999; font-style: italic">// few command-line arguments</span>
  <span style="color: #6ab825; font-weight: bold">if</span><span style="color: #d0d0d0">(</span> <span style="color: #d0d0d0">argc</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #3677a9">1</span> <span style="color: #d0d0d0">){</span>
    <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Bad Usage: &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">argv[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">&lt;&lt;</span>
      <span style="color: #ed9d13">&quot; read also input file on same line&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
    <span style="color: #d0d0d0">exit(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">}</span>
  <span style="color: #6ab825; font-weight: bold">else</span><span style="color: #d0d0d0">{</span>
    <span style="color: #d0d0d0">infilename=argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">];</span>
  <span style="color: #d0d0d0">}</span>
  <span style="color: #d0d0d0">ifile.open(infilename);</span>
  <span style="color: #d0d0d0">....</span>
  <span style="color: #d0d0d0">ifile.close();</span>  <span style="color: #999999; font-style: italic">// close input file</span>
</pre></div>
<p>

</section>


<section>

<h2>File handling, C++-way  <a name="___sec76"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">filename1</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;myfile&quot;</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">ifstream</span> <span style="color: #447fcf">ifile</span><span style="color: #d0d0d0">(filename1);</span>
<span style="color: #d0d0d0">string</span> <span style="color: #d0d0d0">filename2</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">filename1</span> <span style="color: #d0d0d0">+</span> <span style="color: #ed9d13">&quot;.out&quot;</span>
<span style="color: #d0d0d0">ofstream</span> <span style="color: #d0d0d0">ofile(filename2);</span>  <span style="color: #999999; font-style: italic">// new output file</span>
<span style="color: #d0d0d0">ofstream</span> <span style="color: #447fcf">ofile</span><span style="color: #d0d0d0">(filename2,</span> <span style="color: #d0d0d0">ios_base::app);</span>  <span style="color: #999999; font-style: italic">// append</span>

<span style="color: #999999; font-style: italic">//      Read something from the file:</span>

<span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">a;</span> <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">b;</span> <span style="color: #6ab825; font-weight: bold">char</span> <span style="color: #d0d0d0">c[</span><span style="color: #3677a9">200</span><span style="color: #d0d0d0">];</span>
<span style="color: #d0d0d0">ifile</span> <span style="color: #d0d0d0">&gt;&gt;</span> <span style="color: #d0d0d0">a</span> <span style="color: #d0d0d0">&gt;&gt;</span> <span style="color: #d0d0d0">b</span> <span style="color: #d0d0d0">&gt;&gt;</span> <span style="color: #d0d0d0">c;</span>  <span style="color: #999999; font-style: italic">// skips white space in between</span>

<span style="color: #999999; font-style: italic">//      Can test on success of reading:</span>

<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(!(ifile</span> <span style="color: #d0d0d0">&gt;&gt;</span> <span style="color: #d0d0d0">a</span> <span style="color: #d0d0d0">&gt;&gt;</span> <span style="color: #d0d0d0">b</span> <span style="color: #d0d0d0">&gt;&gt;</span> <span style="color: #d0d0d0">c))</span> <span style="color: #d0d0d0">ok</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
</pre></div>
<p>

</section>


<section>

<h2>Call by value and reference  <a name="___sec77"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span> <span style="color: #d0d0d0">argv[])</span> <span style="color: #d0d0d0">{</span>
<span style="color: #6ab825; font-weight: bold">int</span>  <span style="color: #d0d0d0">a:</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*b;</span>
<span style="color: #d0d0d0">a</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">10</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">b</span> <span style="color: #d0d0d0">=</span> <span style="color: #6ab825; font-weight: bold">new</span> <span style="color: #6ab825; font-weight: bold">int</span><span style="color: #d0d0d0">[</span><span style="color: #3677a9">10</span><span style="color: #d0d0d0">];</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">(i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #3677a9">10</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
  <span style="color: #d0d0d0">b[i]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">i;</span>
<span style="color: #d0d0d0">}</span>
<span style="color: #d0d0d0">func(a,</span> <span style="color: #d0d0d0">b);</span>
<span style="color: #6ab825; font-weight: bold">delete</span> <span style="color: #d0d0d0">[]</span> <span style="color: #d0d0d0">b;</span>
<span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">}</span>
</pre></div>
<p>

</section>


<section>

<h2>Call by value and reference  <a name="___sec78"></a></h2>

Morten: Too complicated LaTeX code for computer code to be
decoded....

<p>

</section>


<section>

<h2>Call by value and reference  <a name="___sec79"></a></h2>

<ul>
  <p><li> Lines 1,2: Declaration of two variables <code>a</code> and <code>b</code>. The compiler reserves two locations in memory. The size of the location depends on the type of variable. Two properties are important for these locations: the address in memory and the content in the location. The value of <code>a</code> is <code>a</code>. The address of <code>a</code> is <code>&a</code>. The value of <code>b</code> is <code>*b</code>. The address of <code>b</code> is <code>&b</code>.</li>
  <p><li> Line 3: The value of <code>a</code> is now 10.</li>
  <p><li> Line 4: Memory to store 10 integers is reserved. The address to the first location is stored in b. Address to element number 6 is given by the expression (b + 6).</li>
  <p><li> Line 5: All 10 elements of <code>b</code> are given values: <code>b[0] = 0</code>, <code>b[1] = 1</code>, ....., <code>b[9] = 9</code></li>
  <p><li> line 7: here we deallocate the variable <code>b</code>.</li>
</ul>
<p>


</section>


<section>

<h2>Call by value and reference  <a name="___sec80"></a></h2>

<ul>
  <p><li> Line 6: The <code>main()</code> function calls the function <code>func()</code> and the program counter transfers to the first statement in <code>func()</code>. With respect to data the following happens. The content of <code>a</code> (= 10) and the content of <code>b</code> (a memory address) are copied to a stack (new memory location) associated with the function <code>func()</code></li>
  <p><li> Line 7: The variable <code>x</code> and <code>y</code> are local variables in <code>func()</code>. They have the values  <code>x = 10</code>, <code>y</code> is the address of the first element in <code>b</code> in <code>main()</code>.</li>
  <p><li> Line 8: The local variable <code>x</code> stored in the stack memory is changed to 17. Nothing happens with the value <code>a</code> in <code>main()</code>.</li>
</ul>
<p>


</section>


<section>

<h2>Call by value and reference  <a name="___sec81"></a></h2>

<ul>
  <p><li> Line 9: The value of y is an address and the symbol <code>*y</code> means the position in memory which has this address. The value in this location is now increased by 10. This means that the value of <code>b[0]</code> in the main program is equal to 10. Thus func() has modified a value in <code>main()</code>.</li>
  <p><li> Line 10: This statement has the same effect as line 9 except that it modifies the element <code>b[6]</code> in <code>main()</code> by adding a value of 10 to what was there originally, namely 5.</li>
  <p><li> Line 11: The program counter returns to <code>main()</code>, the next expression after <code>func(a,b)</code>. All data on the stack associated with <code>func()</code> are destroyed.</li>
</ul>
<p>


</section>


<section>

<h2>Call by value and reference  <a name="___sec82"></a></h2>

<ul>
  <p><li> The value of a is transferred to <code>func()</code> and stored in a new memory location called <code>x</code>. Any modification of <code>x</code> in <code>func()</code> does not affect in any way the value of <code>a</code> in <code>main()</code>. This is called <em>transfer of data by value</em>.</li>
  <p><li> On the other hand the next argument in <code>func()</code> is an address which is transferred to <code>func()</code>. This address can be used to modify the corresponding value in <code>main()</code>. In the C language it is expressed as a modification of the value which <code>y</code> points to, namely the first element of <code>b</code>. This is called <em>transfer of data by reference</em> and is a method to transfer data back to the calling function, in this case <code>main()</code>.</li>
</ul>
<p>


</section>


<section>

<h2>Call by value and reference  <a name="___sec83"></a></h2>

C++ allows however the programmer to use solely call by reference
(note that call by reference is implemented as pointers).
To see the difference between C and C++, consider the following simple
examples. In C we would write

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">=</span><span style="color: #3677a9">8</span><span style="color: #d0d0d0">;</span>
   <span style="color: #d0d0d0">func(&amp;n);</span> <span style="color: #999999; font-style: italic">/* &amp;n is a pointer to n */</span>
   <span style="color: #d0d0d0">....</span>
   <span style="color: #6ab825; font-weight: bold">void</span> <span style="color: #d0d0d0">func(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">*i)</span>
   <span style="color: #d0d0d0">{</span>
     <span style="color: #d0d0d0">*i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">10</span><span style="color: #d0d0d0">;</span> <span style="color: #999999; font-style: italic">/* n is changed to 10 */</span>
     <span style="color: #d0d0d0">....</span>
   <span style="color: #d0d0d0">}</span>
</pre></div>
<p>
whereas in C++ we would write

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">=</span><span style="color: #3677a9">8</span><span style="color: #d0d0d0">;</span>
   <span style="color: #d0d0d0">func(n);</span> <span style="color: #999999; font-style: italic">// just transfer n itself</span>
   <span style="color: #d0d0d0">....</span>
   <span style="color: #6ab825; font-weight: bold">void</span> <span style="color: #d0d0d0">func(</span><span style="color: #6ab825; font-weight: bold">int</span><span style="color: #d0d0d0">&amp;</span> <span style="color: #d0d0d0">i)</span>
   <span style="color: #d0d0d0">{</span>
     <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">10</span><span style="color: #d0d0d0">;</span> <span style="color: #999999; font-style: italic">// n is changed to 10</span>
     <span style="color: #d0d0d0">....</span>
   <span style="color: #d0d0d0">}</span>
</pre></div>
<p>
The reason why we emphasize the difference between call by value and call
by reference is that it allows the programmer to avoid pitfalls
like unwanted changes of variables. However, many people feel that this
reduces the readability of the code.

<p>

</section>


<section>

<h2>Call by value and reference, F90/95  <a name="___sec84"></a></h2>

In Fortran we can use <code>INTENT(IN)</code>, <code>INTENT(OUT)</code>, <code>INTENT(INOUT)</code> to let the
program know which values should or should not be changed.

<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">SUBROUTINE </span><span style="color: #40ffff">coulomb_integral</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">np</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">lp</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">n</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">l</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">coulomb</span><span style="color: #d0d0d0">)</span>
  <span style="color: #6ab825; font-weight: bold">USE </span><span style="color: #40ffff">effective_interaction_declar</span>
  <span style="color: #6ab825; font-weight: bold">USE </span><span style="color: #40ffff">energy_variables</span>
  <span style="color: #6ab825; font-weight: bold">USE </span><span style="color: #40ffff">wave_functions</span>
  <span style="color: #6ab825; font-weight: bold">IMPLICIT NONE</span>
<span style="color: #6ab825; font-weight: bold">  INTEGER</span><span style="color: #d0d0d0">,</span> <span style="color: #6ab825; font-weight: bold">INTENT</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">IN</span><span style="color: #d0d0d0">)</span>  <span style="color: #6ab825; font-weight: bold">::</span> <span style="color: #40ffff">n</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">l</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">np</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">lp</span>
  <span style="color: #6ab825; font-weight: bold">INTEGER</span> <span style="color: #6ab825; font-weight: bold">::</span> <span style="color: #40ffff">i</span>
  <span style="color: #6ab825; font-weight: bold">REAL</span><span style="color: #d0d0d0">(</span><span style="color: #24909d">KIND</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">8</span><span style="color: #d0d0d0">),</span> <span style="color: #6ab825; font-weight: bold">INTENT</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">INOUT</span><span style="color: #d0d0d0">)</span> <span style="color: #6ab825; font-weight: bold">::</span> <span style="color: #40ffff">coulomb</span>
  <span style="color: #6ab825; font-weight: bold">REAL</span><span style="color: #d0d0d0">(</span><span style="color: #24909d">KIND</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">8</span><span style="color: #d0d0d0">)</span> <span style="color: #6ab825; font-weight: bold">::</span> <span style="color: #40ffff">z_rel</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">oscl_r</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">sum_coulomb</span>
  <span style="color: #a61717; background-color: #e3d2d2">...</span>
</pre></div>
<p>
This hinders unwanted changes and increases readability.

<p>

</section>


<section>

<h2>Important Matrix and vector handling packages  <a name="___sec85"></a></h2>

The Numerical Recipes codes have been rewritten in Fortran 90/95 and
C/C++ by us.  The original source codes are taken from the widely used
software package LAPACK, which follows two other popular packages
developed in the 1970s, namely EISPACK and LINPACK.

<ul>
  <p><li> LINPACK: package for linear equations and least square problems.</li>
  <p><li> LAPACK:package for solving symmetric, unsymmetric and generalized eigenvalue problems. From LAPACK's website <a href="http://www.netlib.org" target="_blank"><tt>http://www.netlib.org</tt></a> it is possible to download for free all source codes from this library. Both C/C++ and Fortran versions are available.</li>
  <p><li> BLAS (I, II and III): (Basic Linear Algebra Subprograms) are routines that provide standard building blocks for performing basic vector and matrix operations. Blas I is vector operations, II vector-matrix operations and III matrix-matrix operations. Highly parallelized and efficient codes, all available for download from <a href="http://www.netlib.org" target="_blank"><tt>http://www.netlib.org</tt></a>.</li>
</ul>
<p>


</section>


<section>

<h2>Basic Matrix Features  <a name="___sec86"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Matrix properties reminder.</b>
<p>
<p>&nbsp;<br>
$$
 {\bf A} =
      \left( \begin{array}{cccc} a_{11} & a_{12} & a_{13} & a_{14} \\
                                 a_{21} & a_{22} & a_{23} & a_{24} \\
                                   a_{31} & a_{32} & a_{33} & a_{34} \\
                                  a_{41} & a_{42} & a_{43} & a_{44}
             \end{array} \right)\qquad
{\bf I} =
      \left( \begin{array}{cccc} 1 & 0 & 0 & 0 \\
                                 0 & 1 & 0 & 0 \\
                                 0 & 0 & 1 & 0 \\
                                 0 & 0 & 0 & 1
             \end{array} \right)
$$
<p>&nbsp;<br>


<p>
The inverse of a matrix is defined by

<p>&nbsp;<br>
$$
{\bf A}^{-1} \cdot {\bf A} = I
$$
<p>&nbsp;<br>
</div>


<p>

</section>


<section>

<h2>Basic Matrix Features  <a name="___sec87"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Matrix Properties Reminder.</b>
<p>

<p>
<table border="1">
<thead>
<tr><th align="center">                               Relations                               </th> <th align="center">                                  Name                                 </th> <th align="center">                            matrix elements                            </th> </tr>
</thead>
<tbody>
<tr><td align="center">   \( A = A^{T} \)                                                            </td> <td align="center">   symmetric                                                                  </td> <td align="center">   \( a_{ij} = a_{ji} \)                                                      </td> </tr>
<tr><td align="center">   \( A = \left (A^{T} \right )^{-1} \)                                       </td> <td align="center">   real orthogonal                                                            </td> <td align="center">   \( \sum_k a_{ik} a_{jk} = \sum_k a_{ki} a_{kj} = \delta_{ij} \)            </td> </tr>
<tr><td align="center">   \( A = A^{*} \)                                                            </td> <td align="center">   real matrix                                                                </td> <td align="center">   \( a_{ij} = a_{ij}^{*} \)                                                  </td> </tr>
<tr><td align="center">   \( A = A^{\dagger} \)                                                      </td> <td align="center">   hermitian                                                                  </td> <td align="center">   \( a_{ij} = a_{ji}^{*} \)                                                  </td> </tr>
<tr><td align="center">   \( A = \left (A^{\dagger} \right )^{-1} \)                                 </td> <td align="center">   unitary                                                                    </td> <td align="center">   \( \sum_k a_{ik} a_{jk}^{*} = \sum_k a_{ki}^{*} a_{kj} = \delta_{ij} \)    </td> </tr>
</tbody>
</table>

</div>


<p>

</section>


<section>

<h2>Some famous Matrices  <a name="___sec88"></a></h2>

<ul>
  <p><li> Diagonal if \( a_{ij}=0 \) for \( i\ne j \)</li>
  <p><li> Upper triangular if \( a_{ij}=0 \) for \( i > j \)</li>
  <p><li> Lower triangular if \( a_{ij}=0 \) for \( i < j \)</li>
  <p><li> Upper Hessenberg if \( a_{ij}=0 \) for \( i > j+1 \)</li>
  <p><li> Lower Hessenberg if \( a_{ij}=0 \) for \( i < j+1 \)</li>
  <p><li> Tridiagonal if \( a_{ij}=0 \) for \( |i -j| > 1 \)</li>
  <p><li> Lower banded with bandwidth \( p \): \( a_{ij}=0 \) for \( i > j+p \)</li>
  <p><li> Upper banded with bandwidth \( p \): \( a_{ij}=0 \) for \( i < j+p \)</li>
  <p><li> Banded, block upper triangular, block lower triangular....</li>
</ul>
<p>


</section>


<section>

<h2>Basic Matrix Features  <a name="___sec89"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Some Equivalent Statements.</b>
<p>
For an \( N\times N \) matrix  \( {\bf A} \) the following properties are all equivalent

<ul>
  <p><li> If the inverse of \( {\bf A} \) exists, \( {\bf A} \) is nonsingular.</li>
  <p><li> The equation \( {\bf Ax}=0 \) implies \( {\bf x}=0 \).</li>
  <p><li> The rows of \( {\bf A} \) form a basis of \( R^N \).</li>
  <p><li> The columns of \( {\bf A} \) form a basis of \( R^N \).</li>
  <p><li> \( {\bf A} \) is a product of elementary matrices.</li>
  <p><li> \( 0 \) is not eigenvalue of \( {\bf A} \).</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Important Mathematical Operations  <a name="___sec90"></a></h2>

The basic matrix operations that we will deal with are addition and subtraction

<p>&nbsp;<br>
$$
\begin{equation}
{\bf A}= {\bf B}\pm{\bf C}  \Longrightarrow a_{ij} = b_{ij}\pm c_{ij},
\tag{2}
\end{equation}
$$
<p>&nbsp;<br>

scalar-matrix multiplication

<p>&nbsp;<br>
$$
\begin{equation}
{\bf A}= \gamma{\bf B}  \Longrightarrow a_{ij} = \gamma b_{ij},
\end{equation}
$$
<p>&nbsp;<br>

vector-matrix multiplication

<p>&nbsp;<br>
$$
\begin{equation}
{\bf y}={\bf Ax}   \Longrightarrow y_{i} = \sum_{j=1}^{n} a_{ij}x_j,
\tag{3}
\end{equation}
$$
<p>&nbsp;<br>

matrix-matrix multiplication

<p>&nbsp;<br>
$$
\begin{equation}
{\bf A}={\bf BC}   \Longrightarrow a_{ij} = \sum_{k=1}^{n} b_{ik}c_{kj},
\tag{4}
\end{equation}
$$
<p>&nbsp;<br>

and transposition

<p>&nbsp;<br>
$$
\begin{equation}
{\bf A}={\bf B}^T   \Longrightarrow a_{ij} = b_{ji}
\end{equation}
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Important Mathematical Operations  <a name="___sec91"></a></h2>

Similarly, important vector operations that we will deal with are addition and subtraction

<p>&nbsp;<br>
$$
\begin{equation}
{\bf x}= {\bf y}\pm{\bf z}  \Longrightarrow x_{i} = y_{i}\pm z_{i},
\end{equation}
$$
<p>&nbsp;<br>

scalar-vector multiplication

<p>&nbsp;<br>
$$
\begin{equation}
{\bf x}= \gamma{\bf y}  \Longrightarrow x_{i} = \gamma y_{i},
\end{equation}
$$
<p>&nbsp;<br>

vector-vector multiplication (called Hadamard multiplication)

<p>&nbsp;<br>
$$
\begin{equation}
{\bf x}={\bf yz}   \Longrightarrow x_{i} = y_{i}z_i,
\end{equation}
$$
<p>&nbsp;<br>

the inner or so-called dot product  resulting in a constant

<p>&nbsp;<br>
$$
\begin{equation}
x={\bf y}^T{\bf z}   \Longrightarrow x = \sum_{j=1}^{n} y_{j}z_{j},
\tag{5}
\end{equation}
$$
<p>&nbsp;<br>

and the outer product, which yields a matrix,

<p>&nbsp;<br>
$$
\begin{equation}
{\bf A}=  {\bf yz}^T \Longrightarrow  a_{ij} = y_{i}z_{j},
\tag{6}
\end{equation}
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Matrix Handling in C/C++, Static and Dynamical allocation  <a name="___sec92"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Static.</b>
<p>
We have  an \( N\times N \) matrix A  with \( N=100 \)
In C/C++ this would be  defined as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">100</span><span style="color: #d0d0d0">;</span>
   <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">A[</span><span style="color: #3677a9">100</span><span style="color: #d0d0d0">][</span><span style="color: #3677a9">100</span><span style="color: #d0d0d0">];</span>
   <span style="color: #999999; font-style: italic">//   initialize all elements to zero</span>
   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
      <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(j=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j++)</span> <span style="color: #d0d0d0">{</span>
         <span style="color: #d0d0d0">A[i][j]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.0</span><span style="color: #d0d0d0">;</span>
</pre></div>
<p>
Note the way the matrix is organized, row-major order.
</div>


<p>

</section>


<section>

<h2>Matrix Handling in C/C++  <a name="___sec93"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Row Major Order, Addition.</b>
<p>
We have  \( N\times N \) matrices A, B and C and we wish to
evaluate \( A=B+C \).

<p>&nbsp;<br>
$$
{\bf A}= {\bf B}\pm{\bf C}  \Longrightarrow a_{ij} = b_{ij}\pm c_{ij},
$$
<p>&nbsp;<br>

In C/C++ this would be coded like

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
      <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(j=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j++)</span> <span style="color: #d0d0d0">{</span>
         <span style="color: #d0d0d0">a[i][j]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">b[i][j]+c[i][j]</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Matrix Handling in C/C++  <a name="___sec94"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Row Major Order, Multiplication.</b>
<p>
We have  \( N\times N \) matrices A, B and C and we wish to
evaluate \( A=BC \).

<p>&nbsp;<br>
$$
{\bf A}={\bf BC}   \Longrightarrow a_{ij} = \sum_{k=1}^{n} b_{ik}c_{kj},
$$
<p>&nbsp;<br>

In C/C++ this would be coded like

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
      <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(j=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j++)</span> <span style="color: #d0d0d0">{</span>
         <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(k=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">k</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">k++)</span> <span style="color: #d0d0d0">{</span>
            <span style="color: #d0d0d0">a[i][j]+=b[i][k]*c[k][j];</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Matrix Handling in Fortran 90/95  <a name="___sec95"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Column Major Order.</b>
<p>
<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">ALLOCATE</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">a</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">N</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">N</span><span style="color: #d0d0d0">),</span> <span style="color: #40ffff">b</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">N</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">N</span><span style="color: #d0d0d0">),</span> <span style="color: #40ffff">c</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">N</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">N</span><span style="color: #d0d0d0">))</span>
   <span style="color: #6ab825; font-weight: bold">DO </span><span style="color: #40ffff">j</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span>  <span style="color: #40ffff">N</span>
      <span style="color: #6ab825; font-weight: bold">DO </span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">N</span>
         <span style="color: #40ffff">a</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">j</span><span style="color: #d0d0d0">)=</span><span style="color: #40ffff">b</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">j</span><span style="color: #d0d0d0">)+</span><span style="color: #40ffff">c</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">i</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">j</span><span style="color: #d0d0d0">)</span>
      <span style="color: #40ffff">ENDDO</span>
   <span style="color: #40ffff">ENDDO</span>
   <span style="color: #a61717; background-color: #e3d2d2">...</span>
   <span style="color: #6ab825; font-weight: bold">DEALLOCATE</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">a</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">b</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">c</span><span style="color: #d0d0d0">)</span>
</pre></div>
<p>
Fortran 90 writes the above statements in a much simpler way

<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #40ffff">a</span><span style="color: #d0d0d0">=</span><span style="color: #40ffff">b</span><span style="color: #d0d0d0">+</span><span style="color: #40ffff">c</span>
</pre></div>
<p>
Multiplication

<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #40ffff">a</span><span style="color: #d0d0d0">=</span><span style="color: #24909d">MATMUL</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">b</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">c</span><span style="color: #d0d0d0">)</span>
</pre></div>
<p>
Fortran contains also the intrinsic functions TRANSPOSE and CONJUGATE.
</div>


<p>

</section>


<section>

<h2>Dynamic memory allocation in C/C++  <a name="___sec96"></a></h2>

At least three possibilities in this course

<ul>
  <p><li> Do it yourself</li>
  <p><li> Use the functions provided in the library package lib.cpp</li>
  <p><li> Use Armadillo <a href="http://arma.sourceforgenet" target="_blank"><tt>http://arma.sourceforgenet</tt></a> (a C++ linear algebra library, discussion next two weeks, both here and at lab). !split</li>
</ul>
<p>

<h2>Matrix Handling in C/C++, Dynamic Allocation  <a name="___sec97"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Do it yourself.</b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">N;</span>
<span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">**</span>  <span style="color: #d0d0d0">A;</span>
<span style="color: #d0d0d0">A</span> <span style="color: #d0d0d0">=</span> <span style="color: #6ab825; font-weight: bold">new</span> <span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">*[N]</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">(</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N;</span> <span style="color: #d0d0d0">i++)</span>
    <span style="color: #d0d0d0">A[i]</span> <span style="color: #d0d0d0">=</span> <span style="color: #6ab825; font-weight: bold">new</span> <span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">[N];</span>
</pre></div>
<p>
Always free space when you don't need an array anymore.

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">(</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">N;</span> <span style="color: #d0d0d0">i++)</span>
    <span style="color: #6ab825; font-weight: bold">delete</span><span style="color: #d0d0d0">[]</span> <span style="color: #d0d0d0">A[i];</span>
<span style="color: #6ab825; font-weight: bold">delete</span><span style="color: #d0d0d0">[]</span> <span style="color: #d0d0d0">A;</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2>Armadillo, recommended!!  <a name="___sec98"></a></h2>

<ul>
  <p><li> Armadillo is a C++ linear algebra library (matrix maths) aiming towards a good balance between speed and ease of use. The syntax is deliberately similar to Matlab.</li>
  <p><li> Integer, floating point and complex numbers are supported, as well as a subset of trigonometric and statistics functions. Various matrix decompositions are provided through optional integration with LAPACK, or one of its high performance drop-in replacements (such as the multi-threaded MKL or ACML libraries).</li>
  <p><li> A delayed evaluation approach is employed (at compile-time) to combine several operations into one and reduce (or eliminate) the need for temporaries. This is accomplished through recursive templates and template meta-programming.</li>
  <p><li> Useful for conversion of research code into production environments, or if C++ has been decided as the language of choice, due to speed and/or integration capabilities.</li>
  <p><li> The library is open-source software, and is distributed under a license that is useful in both open-source and commercial/proprietary contexts.</li>
</ul>
<p>


</section>


<section>

<h2>Armadillo, simple examples  <a name="___sec99"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;armadillo&gt;</span>

<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">arma;</span>

<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">**</span> <span style="color: #d0d0d0">argv)</span>
  <span style="color: #d0d0d0">{</span>
  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">A</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">randu&lt;mat&gt;(</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">B</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">randu&lt;mat&gt;(</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">);</span>

  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">A*B</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>

  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
</pre></div>
<p>

</section>


<section>

<h2>Armadillo, how to compile and install  <a name="___sec100"></a></h2>

For people using Ubuntu, Debian, Linux Mint, simply go to the synaptic package manager and install
armadillo from there.
You may have to install Lapack as well.
For Mac and Windows users, follow the instructions from the webpage
<a href="http://arma.sourceforge.net" target="_blank"><tt>http://arma.sourceforge.net</tt></a>.
To compile, use for example

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">c++</span> <span style="color: #d0d0d0">-O2</span> <span style="color: #d0d0d0">-o</span> <span style="color: #d0d0d0">program.x</span> <span style="color: #d0d0d0">program.cpp</span>  <span style="color: #d0d0d0">-larmadillo</span> <span style="color: #d0d0d0">-llapack</span> <span style="color: #d0d0d0">-lblas</span>
</pre></div>
<p>
where the <code>-l</code> option indicates the library you wish to link to.

<p>

</section>


<section>

<h2>Armadillo, simple examples  <a name="___sec101"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &quot;armadillo&quot;</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">arma;</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span>

<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">**</span> <span style="color: #d0d0d0">argv)</span>
  <span style="color: #d0d0d0">{</span>
  <span style="color: #999999; font-style: italic">// directly specify the matrix size (elements are uninitialised)</span>
  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">A(</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">);</span>
  <span style="color: #999999; font-style: italic">// .n_rows = number of rows    (read only)</span>
  <span style="color: #999999; font-style: italic">// .n_cols = number of columns (read only)</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;A.n_rows = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">A.n_rows</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;A.n_cols = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">A.n_cols</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #999999; font-style: italic">// directly access an element (indexing starts at 0)</span>
  <span style="color: #d0d0d0">A(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">456.0</span><span style="color: #d0d0d0">;</span>
  <span style="color: #d0d0d0">A.print(</span><span style="color: #ed9d13">&quot;A:&quot;</span><span style="color: #d0d0d0">);</span>
  <span style="color: #999999; font-style: italic">// scalars are treated as a 1x1 matrix,</span>
  <span style="color: #999999; font-style: italic">// hence the code below will set A to have a size of 1x1</span>
  <span style="color: #d0d0d0">A</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">5.0</span><span style="color: #d0d0d0">;</span>
  <span style="color: #d0d0d0">A.print(</span><span style="color: #ed9d13">&quot;A:&quot;</span><span style="color: #d0d0d0">);</span>
  <span style="color: #999999; font-style: italic">// if you want a matrix with all elements set to a particular value</span>
  <span style="color: #999999; font-style: italic">// the .fill() member function can be used</span>
  <span style="color: #d0d0d0">A.set_size(</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">A.fill(</span><span style="color: #3677a9">5.0</span><span style="color: #d0d0d0">);</span>  <span style="color: #d0d0d0">A.print(</span><span style="color: #ed9d13">&quot;A:&quot;</span><span style="color: #d0d0d0">);</span>
</pre></div>
<p>

</section>


<section>

<h2>Armadillo, simple examples  <a name="___sec102"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">B;</span>

  <span style="color: #999999; font-style: italic">// endr indicates &quot;end of row&quot;</span>
  <span style="color: #d0d0d0">B</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.555950</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.274690</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.540605</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.798938</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr</span>
    <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.108929</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.830123</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.891726</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.895283</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr</span>
    <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.948014</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.973234</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.216504</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.883152</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr</span>
    <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.023787</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.675382</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.231751</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.450332</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr;</span>

  <span style="color: #999999; font-style: italic">// print to the cout stream</span>
  <span style="color: #999999; font-style: italic">// with an optional string before the contents of the matrix</span>
  <span style="color: #d0d0d0">B.print(</span><span style="color: #ed9d13">&quot;B:&quot;</span><span style="color: #d0d0d0">);</span>

  <span style="color: #999999; font-style: italic">// the &lt;&lt; operator can also be used to print the matrix</span>
  <span style="color: #999999; font-style: italic">// to an arbitrary stream (cout in this case)</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;B:&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">B</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #999999; font-style: italic">// save to disk</span>
  <span style="color: #d0d0d0">B.save(</span><span style="color: #ed9d13">&quot;B.txt&quot;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">raw_ascii);</span>
  <span style="color: #999999; font-style: italic">// load from disk</span>
  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">C;</span>
  <span style="color: #d0d0d0">C.load(</span><span style="color: #ed9d13">&quot;B.txt&quot;</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">C</span> <span style="color: #d0d0d0">+=</span> <span style="color: #3677a9">2.0</span> <span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">B;</span>
  <span style="color: #d0d0d0">C.print(</span><span style="color: #ed9d13">&quot;C:&quot;</span><span style="color: #d0d0d0">);</span>
</pre></div>
<p>

</section>


<section>

<h2>Armadillo, simple examples  <a name="___sec103"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #999999; font-style: italic">// submatrix types:</span>
  <span style="color: #999999; font-style: italic">//</span>
  <span style="color: #999999; font-style: italic">// .submat(first_row, first_column, last_row, last_column)</span>
  <span style="color: #999999; font-style: italic">// .row(row_number)</span>
  <span style="color: #999999; font-style: italic">// .col(column_number)</span>
  <span style="color: #999999; font-style: italic">// .cols(first_column, last_column)</span>
  <span style="color: #999999; font-style: italic">// .rows(first_row, last_row)</span>

  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;C.submat(0,0,3,1) =&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">C.submat(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>

  <span style="color: #999999; font-style: italic">// generate the identity matrix</span>
  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">D</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">eye&lt;mat&gt;(</span><span style="color: #3677a9">4</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">4</span><span style="color: #d0d0d0">);</span>

  <span style="color: #d0d0d0">D.submat(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">C.cols(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">D.print(</span><span style="color: #ed9d13">&quot;D:&quot;</span><span style="color: #d0d0d0">);</span>

  <span style="color: #999999; font-style: italic">// transpose</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;trans(B) =&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">trans(B)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>

  <span style="color: #999999; font-style: italic">// maximum from each column (traverse along rows)</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;max(B) =&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">max(B)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
</pre></div>
<p>

</section>


<section>

<h2>Armadillo, simple examples  <a name="___sec104"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #999999; font-style: italic">// maximum from each row (traverse along columns)</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;max(B,1) =&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">max(B,</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #999999; font-style: italic">// maximum value in B</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;max(max(B)) = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">max(max(B))</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #999999; font-style: italic">// sum of each column (traverse along rows)</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;sum(B) =&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">sum(B)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #999999; font-style: italic">// sum of each row (traverse along columns)</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;sum(B,1) =&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">sum(B,</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #999999; font-style: italic">// sum of all elements</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;sum(sum(B)) = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">sum(sum(B))</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;accu(B)     = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">accu(B)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #999999; font-style: italic">// trace = sum along diagonal</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;trace(B)    = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">trace(B)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #999999; font-style: italic">// random matrix -- values are uniformly distributed in the [0,1] interval</span>
  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">E</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">randu&lt;mat&gt;(</span><span style="color: #3677a9">4</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">4</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">E.print(</span><span style="color: #ed9d13">&quot;E:&quot;</span><span style="color: #d0d0d0">);</span>
</pre></div>
<p>

</section>


<section>

<h2>Armadillo, simple examples  <a name="___sec105"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #999999; font-style: italic">// row vectors are treated like a matrix with one row</span>
  <span style="color: #d0d0d0">rowvec</span> <span style="color: #d0d0d0">r;</span>
  <span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.59499</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.88807</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.88532</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.19968</span><span style="color: #d0d0d0">;</span>
  <span style="color: #d0d0d0">r.print(</span><span style="color: #ed9d13">&quot;r:&quot;</span><span style="color: #d0d0d0">);</span>

  <span style="color: #999999; font-style: italic">// column vectors are treated like a matrix with one column</span>
  <span style="color: #d0d0d0">colvec</span> <span style="color: #d0d0d0">q;</span>
  <span style="color: #d0d0d0">q</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.81114</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.06256</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.95989</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.73628</span><span style="color: #d0d0d0">;</span>
  <span style="color: #d0d0d0">q.print(</span><span style="color: #ed9d13">&quot;q:&quot;</span><span style="color: #d0d0d0">);</span>

  <span style="color: #999999; font-style: italic">// dot or inner product</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;as_scalar(r*q) = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">as_scalar(r*q)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>

    <span style="color: #999999; font-style: italic">// outer product</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;q*r =&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">q*r</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>


  <span style="color: #999999; font-style: italic">// sum of three matrices (no temporary matrices are created)</span>
  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">F</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">B</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">C</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">D;</span>
  <span style="color: #d0d0d0">F.print(</span><span style="color: #ed9d13">&quot;F:&quot;</span><span style="color: #d0d0d0">);</span>

    <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
</pre></div>
<p>

</section>


<section>

<h2>Armadillo, simple examples  <a name="___sec106"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &quot;armadillo&quot;</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">arma;</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span>

<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">argc,</span> <span style="color: #6ab825; font-weight: bold">char</span><span style="color: #d0d0d0">**</span> <span style="color: #d0d0d0">argv)</span>
  <span style="color: #d0d0d0">{</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Armadillo version: &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">arma_version::as_string()</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>

  <span style="color: #d0d0d0">mat</span> <span style="color: #d0d0d0">A;</span>

  <span style="color: #d0d0d0">A</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.165300</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.454037</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.995795</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.124098</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.047084</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr</span>
    <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.688782</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.036549</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.552848</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.937664</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.866401</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr</span>
    <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.348740</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.479388</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.506228</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.145673</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.491547</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr</span>
    <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.148678</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.682258</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.571154</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.874724</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.444632</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr</span>
    <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.245726</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.595218</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.409327</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.367827</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #3677a9">0.385736</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endr;</span>

  <span style="color: #d0d0d0">A.print(</span><span style="color: #ed9d13">&quot;A =&quot;</span><span style="color: #d0d0d0">);</span>

  <span style="color: #999999; font-style: italic">// determinant</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;det(A) = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">det(A)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
</pre></div>
<p>

</section>


<section>

<h2>Armadillo, simple examples  <a name="___sec107"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #999999; font-style: italic">// inverse</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;inv(A) = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">inv(A)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">k</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1.23</span><span style="color: #d0d0d0">;</span>

  <span style="color: #d0d0d0">mat</span>    <span style="color: #d0d0d0">B</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">randu&lt;mat&gt;(</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">mat</span>    <span style="color: #d0d0d0">C</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">randu&lt;mat&gt;(</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">);</span>

  <span style="color: #d0d0d0">rowvec</span> <span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">randu&lt;rowvec&gt;(</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">);</span>
  <span style="color: #d0d0d0">colvec</span> <span style="color: #d0d0d0">q</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">randu&lt;colvec&gt;(</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">);</span>


  <span style="color: #999999; font-style: italic">// examples of some expressions</span>
  <span style="color: #999999; font-style: italic">// for which optimised implementations exist</span>
  <span style="color: #999999; font-style: italic">// optimised implementation of a trinary expression</span>
  <span style="color: #999999; font-style: italic">// that results in a scalar</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;as_scalar( r*inv(diagmat(B))*q ) = &quot;</span><span style="color: #d0d0d0">;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">as_scalar(</span> <span style="color: #d0d0d0">r*inv(diagmat(B))*q</span> <span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>

  <span style="color: #999999; font-style: italic">// example of an expression which is optimised</span>
  <span style="color: #999999; font-style: italic">// as a call to the dgemm() function in BLAS:</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;k*trans(B)*C = &quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">k*trans(B)*C;</span>

    <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
</pre></div>
<p>

</section>


<section>

<h2>Gaussian Elimination  <a name="___sec108"></a></h2>

We start with the linear set of equations

<p>&nbsp;<br>
$$
   {\bf A}{\bf x} = {\bf w}.
$$
<p>&nbsp;<br>

We assume also that the matrix \( {\bf A} \) is non-singular and that the
matrix elements along the diagonal satisfy \( a_{ii} \ne 0 \). Simple \( 4\times 4  \) example

<p>&nbsp;<br>
$$
\left(\begin{array}{cccc}
                           a_{11}& a_{12} &a_{13}& a_{14}\\
                           a_{21}& a_{22} &a_{23}& a_{24}\\
                           a_{31}& a_{32} &a_{33}& a_{34}\\
                           a_{41}& a_{42} &a_{43}& a_{44}\\
                      \end{array} \right)\left(\begin{array}{c}
                           x_1\\
                           x_2\\
                           x_3 \\
                           x_4  \\
                      \end{array} \right)
  =\left(\begin{array}{c}
                           w_1\\
                           w_2\\
                           w_3 \\
                           w_4\\
                      \end{array} \right).
$$
<p>&nbsp;<br>

or

<p>&nbsp;<br>
$$
\begin{align}
 a_{11}x_1 +a_{12}x_2 +a_{13}x_3 + a_{14}x_4=&w_1 \nonumber \\
a_{21}x_1 + a_{22}x_2 + a_{23}x_3 + a_{24}x_4=&w_2 \nonumber \\
a_{31}x_1 + a_{32}x_2 + a_{33}x_3 + a_{34}x_4=&w_3 \nonumber \\
a_{41}x_1 + a_{42}x_2 + a_{43}x_3 + a_{44}x_4=&w_4. \nonumber
\end{align}
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Gaussian Elimination  <a name="___sec109"></a></h2>

The basic idea of Gaussian elimination is to use the first equation to eliminate the first unknown \( x_1 \)
from the remaining \( n-1 \) equations. Then we use the new second equation to eliminate the second unknown
\( x_2 \) from the remaining \( n-2 \) equations. With \( n-1 \) such eliminations
we obtain a so-called upper triangular set of equations of the form

<p>&nbsp;<br>
$$
\begin{align}label{eq:gaussbacksub}
 b_{11}x_1 +b_{12}x_2 +b_{13}x_3 + b_{14}x_4=&y_1 \nonumber \\
 b_{22}x_2 + b_{23}x_3 + b_{24}x_4=&y_2 \nonumber \\
b_{33}x_3 + b_{34}x_4=&y_3 \nonumber \\
b_{44}x_4=&y_4. \nonumber
\end{align}
$$
<p>&nbsp;<br>

We can solve this system of equations recursively starting from \( x_n \) (in our case \( x_4 \)) and proceed with
what is called a backward substitution. This process can be expressed mathematically as

<p>&nbsp;<br>
$$
\begin{equation}
   x_m = \frac{1}{b_{mm}}\left(y_m-\sum_{k=m+1}^nb_{mk}x_k\right)\quad m=n-1,n-2,\dots,1.
\end{equation}
$$
<p>&nbsp;<br>

To arrive at such an upper triangular system of equations, we start by eliminating
the unknown \( x_1 \) for \( j=2,n \). We achieve this by multiplying the first equation by \( a_{j1}/a_{11} \) and then subtract
the result from the $j$th equation. We assume obviously that \( a_{11}\ne 0 \) and that
\( {\bf A} \) is not singular.

<p>

</section>


<section>

<h2>Gaussian Elimination  <a name="___sec110"></a></h2>

Our actual \( 4\times 4 \) example reads after the first operation

<p>&nbsp;<br>
$$
\left(\begin{array}{cccc}
                           a_{11}& a_{12} &a_{13}& a_{14}\\
                           0& (a_{22}-\frac{a_{21}a_{12}}{a_{11}}) &(a_{23}-\frac{a_{21}a_{13}}{a_{11}}) & (a_{24}-\frac{a_{21}a_{14}}{a_{11}})\\
0& (a_{32}-\frac{a_{31}a_{12}}{a_{11}})& (a_{33}-\frac{a_{31}a_{13}}{a_{11}})& (a_{34}-\frac{a_{31}a_{14}}{a_{11}})\\
0&(a_{42}-\frac{a_{41}a_{12}}{a_{11}}) &(a_{43}-\frac{a_{41}a_{13}}{a_{11}}) & (a_{44}-\frac{a_{41}a_{14}}{a_{11}}) \\
                      \end{array} \right)\left(\begin{array}{c}
                           x_1\\
                           x_2\\
                           x_3 \\
                           x_4  \\
                      \end{array} \right)
  =\left(\begin{array}{c}
                           y_1\\
                           w_2^{(2)}\\
                           w_3^{(2)} \\
                           w_4^{(2)}\\
                      \end{array} \right),
$$
<p>&nbsp;<br>

or

<p>&nbsp;<br>
$$
\begin{align}
 b_{11}x_1 +b_{12}x_2 +b_{13}x_3 + b_{14}x_4=&y_1 \nonumber \\
 a^{(2)}_{22}x_2 + a^{(2)}_{23}x_3 + a^{(2)}_{24}x_4=&w^{(2)}_2 \nonumber \\
 a^{(2)}_{32}x_2 + a^{(2)}_{33}x_3 + a^{(2)}_{34}x_4=&w^{(2)}_3 \nonumber \\
 a^{(2)}_{42}x_2 + a^{(2)}_{43}x_3 + a^{(2)}_{44}x_4=&w^{(2)}_4, \nonumber \\
\end{align}
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Gaussian Elimination  <a name="___sec111"></a></h2>

The new coefficients are

<p>&nbsp;<br>
$$
\begin{equation}
   b_{1k} = a_{1k}^{(1)} \quad k=1,\dots,n,
\end{equation}
$$
<p>&nbsp;<br>

where each \( a_{1k}^{(1)} \) is equal to the original \( a_{1k} \) element. The other coefficients are

<p>&nbsp;<br>
$$
\begin{equation}
a_{jk}^{(2)} = a_{jk}^{(1)}-\frac{a_{j1}^{(1)}a_{1k}^{(1)}}{a_{11}^{(1)}} \quad j,k=2,\dots,n,
\end{equation}
$$
<p>&nbsp;<br>

with a new right-hand side given by

<p>&nbsp;<br>
$$
\begin{equation}
y_{1}=w_1^{(1)}, \quad w_j^{(2)} =w_j^{(1)}-\frac{a_{j1}^{(1)}w_1^{(1)}}{a_{11}^{(1)}} \quad j=2,\dots,n.
\end{equation}
$$
<p>&nbsp;<br>

We have also set \( w_1^{(1)}=w_1 \), the original vector element.
We see that the system of unknowns \( x_1,\dots,x_n \) is transformed into an \( (n-1)\times (n-1) \) problem.

<p>

</section>


<section>

<h2>Gaussian Elimination  <a name="___sec112"></a></h2>

This step is called forward substitution.
Proceeding with these substitutions, we obtain the
general expressions for the new coefficients

<p>&nbsp;<br>
$$
\begin{equation}
   a_{jk}^{(m+1)} = a_{jk}^{(m)}-\frac{a_{jm}^{(m)}a_{mk}^{(m)}}{a_{mm}^{(m)}} \quad j,k=m+1,\dots,n,
\end{equation}
$$
<p>&nbsp;<br>

with \( m=1,\dots,n-1 \) and a
right-hand side given by

<p>&nbsp;<br>
$$
\begin{equation}
   w_j^{(m+1)} =w_j^{(m)}-\frac{a_{jm}^{(m)}w_m^{(m)}}{a_{mm}^{(m)}}\quad j=m+1,\dots,n.
\end{equation}
$$
<p>&nbsp;<br>

This set of \( n-1 \) elimations leads us to an equations which is solved by back substitution.
If the arithmetics is exact and the matrix \( {\bf A} \) is not singular, then the computed answer will be exact.

<p>
Even though the matrix elements along the diagonal are not zero,
numerically small numbers may appear and subsequent divisions may lead to large numbers, which, if added
to a small number may yield losses of precision. Suppose for example that our first division in \( (a_{22}-a_{21}a_{12}/a_{11}) \)
results in \( -10^{-7} \) and that \( a_{22} \) is one.
one. We are then
adding \( 10^7+1 \). With single precision this results in \( 10^7 \).

<p>

</section>


<section>

<h2>Gaussian Elimination and Tridiagonal matrices, project 1  <a name="___sec113"></a></h2>

Suppose we want to solve the following boundary value equation

<p>&nbsp;<br>
$$
  -\frac{d^2u(x)}{dx^2} = f(x,u(x)),
$$
<p>&nbsp;<br>

with \( x\in (a,b) \) and with boundary conditions \( u(a)=u(b) = 0 \).
We assume that \( f \) is a continuous function in the domain \( x\in (a,b) \).
Since, except the few cases where it is possible to find analytic solutions, we
will seek after approximate solutions, we choose to represent the approximation to the second derivative
from the previous chapter

<p>&nbsp;<br>
$$
  f''=\frac{f_h -2f_0 +f_{-h}}{h^2} +O(h^2).
$$
<p>&nbsp;<br>

We subdivide our interval \( x\in (a,b) \) into \( n \) subintervals by setting \( x_i = ih \), with \( i=0,1,\dots,n+1 \).
The step size is then given by \( h=(b-a)/(n+1) \) with \( n\in {\mathbb{N}} \).
For the internal grid points \( i=1,2,\dots n \) we replace the differential operator with the above formula
resulting in

<p>&nbsp;<br>
$$
u''(x_i) \approx  \frac{u(x_i+h) -2u(x_i) +u(x_i-h)}{h^2},
$$
<p>&nbsp;<br>

which we rewrite as

<p>&nbsp;<br>
$$
u^{''}_i \approx  \frac{u_{i+1} -2u_i +u_{i-i}}{h^2}.
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Gaussian Elimination and Tridiagonal matrices, project 1  <a name="___sec114"></a></h2>

We can rewrite our original differential equation in terms of a discretized equation with approximations to the
derivatives as

<p>&nbsp;<br>
$$
    -\frac{u_{i+1} -2u_i +u_{i-i}}{h^2}=f(x_i,u(x_i)),
$$
<p>&nbsp;<br>

with \( i=1,2,\dots, n \). We need to add to this system the two boundary conditions \( u(a) =u_0 \) and \( u(b) = u_{n+1} \).
If we define a matrix

<p>&nbsp;<br>
$$
    {\bf A} = \frac{1}{h^2}\left(\begin{array}{cccccc}
                          2 & -1 &  &   &  & \\
                          -1 & 2 & -1 & & & \\
                           & -1 & 2 & -1 & &  \\
                           & \dots   & \dots &\dots   &\dots & \dots \\
                           &   &  &-1  &2& -1 \\
                           &    &  &   &-1 & 2 \\
                      \end{array} \right)
$$
<p>&nbsp;<br>

and the corresponding vectors \( {\bf u} = (u_1, u_2, \dots,u_n)^T \) and
\( {\bf f}({\bf u}) = f(x_1,x_2,\dots, x_n,u_1, u_2, \dots,u_n)^T \)  we can rewrite the differential equation
including the boundary conditions as a system of linear equations with  a large number of unknowns

<p>&nbsp;<br>
$$
   {\bf A}{\bf u} = {\bf f}({\bf u}).
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Gaussian Elimination and Tridiagonal matrices, project 1  <a name="___sec115"></a></h2>

We start with the linear set of equations

<p>&nbsp;<br>
$$
   {\bf A}{\bf u} = {\bf f},
$$
<p>&nbsp;<br>

where \( {\bf A} \) is a tridiagonal matrix which we rewrite as

<p>&nbsp;<br>
$$
    {\bf A} = \left(\begin{array}{cccccc}
                           b_1& c_1 & 0 &\dots   & \dots &\dots \\
                           a_2 & b_2 & c_2 &\dots &\dots &\dots \\
                           & a_3 & b_3 & c_3 & \dots & \dots \\
                           & \dots   & \dots &\dots   &\dots & \dots \\
                           &   &  &a_{n-2}  &b_{n-1}& c_{n-1} \\
                           &    &  &   &a_n & b_n \\
                      \end{array} \right)
$$
<p>&nbsp;<br>

where \( a,b,c \) are one-dimensional arrays of length \( 1:n \).
In project 1 the arrays \( a \) and \( c \) are equal, namely \( a_i=c_i=-1/h^2 \).
The matrix is  also positive definite.

<p>

</section>


<section>

<h2>Gaussian Elimination and Tridiagonal matrices, project 1  <a name="___sec116"></a></h2>

We can rewrite as

<p>&nbsp;<br>
$$
    {\bf A} = \left(\begin{array}{cccccc}
                           b_1& c_1 & 0 &\dots   & \dots &\dots \\
                           a_2 & b_2 & c_2 &\dots &\dots &\dots \\
                           & a_3 & b_3 & c_3 & \dots & \dots \\
                           & \dots   & \dots &\dots   &\dots & \dots \\
                           &   &  &a_{n-2}  &b_{n-1}& c_{n-1} \\
                           &    &  &   &a_n & b_n \\
                      \end{array} \right)\left(\begin{array}{c}
                           u_1\\
                           u_2\\
                           \dots \\
                          \dots  \\
                          \dots \\
                           u_n\\
                      \end{array} \right)
  =\left(\begin{array}{c}
                           f_1\\
                           f_2\\
                           \dots \\
                           \dots \\
                          \dots \\
                           f_n\\
                      \end{array} \right).
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Gaussian Elimination and Tridiagonal matrices, project 1  <a name="___sec117"></a></h2>

A tridiagonal matrix is a special form of banded matrix where all the elements are zero except for
those on and immediately above and below the leading diagonal.
The above tridiagonal system   can be written as

<p>&nbsp;<br>
$$
  a_iu_{i-1}+b_iu_i+c_iu_{i+1} = f_i,
$$
<p>&nbsp;<br>

for \( i=1,2,\dots,n \). We see that \( u_{-1} \) and \( u_{n+1} \) are not required and we can set \( a_1=c_n=0 \).
In many applications the matrix is symmetric and we have \( a_i=c_i \).
The algorithm for solving this set of equations is rather simple and requires two steps only,
a forward substitution and a backward substitution. These steps are also
common to the algorithms based on
Gaussian elimination that
we discussed previously. However, due to its simplicity, the number of floating point operations
is in this
case proportional with \( O(n) \) while Gaussian elimination requires \( 2n^3/3+O(n^2) \) floating point operations.

<p>

</section>


<section>

<h2>Gaussian Elimination and Tridiagonal matrices, project 1  <a name="___sec118"></a></h2>

In case your system of equations leads to a tridiagonal matrix, it is clearly an overkill to employ
Gaussian elimination or the standard LU decomposition.
You will encounter several applications involving tridiagonal matrices in our discussion of
partial differential equations in chapter 10.

<p>
Our algorithm starts with forward substitution with a loop over of the elements \( i \) and can be expressed via the
following piece of code

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #d0d0d0">btemp</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">b[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">];</span>
   <span style="color: #d0d0d0">u[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">f[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]/btemp;</span>
   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i=</span><span style="color: #3677a9">2</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
      <span style="color: #d0d0d0">temp[i]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">c[i-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]/btemp;</span>
      <span style="color: #d0d0d0">btemp</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">b[i]-a[i]*temp[i];</span>
      <span style="color: #d0d0d0">u[i]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(f[i]</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">a[i]*u[i-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">])/btemp;</span>
</pre></div>
<p>

</section>


<section>

<h2>Gaussian Elimination and Tridiagonal matrices, project 1  <a name="___sec119"></a></h2>

Note that you should avoid cases with \( b_1=0 \). If that is the case, you should rewrite the equations
as a set of order \( n-1 \) with \( u_2 \) eliminated.
Finally we perform the backsubstitution leading to the following code

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i=n-</span><span style="color: #3677a9">1</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&gt;=</span> <span style="color: #3677a9">1</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i--)</span> <span style="color: #d0d0d0">{</span>
      <span style="color: #d0d0d0">u[i]</span> <span style="color: #d0d0d0">-=</span> <span style="color: #d0d0d0">temp[i+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]*u[i+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">];</span>
</pre></div>
<p>

</section>


<section>

<h2>Gaussian Elimination and Tridiagonal matrices, project 1  <a name="___sec120"></a></h2>

Note that our sums start with \( i=1 \) and that one  should avoid cases with \( b_1=0 \). If that is the case, you should rewrite the equations
as a set of order \( n-1 \) with \( u_2 \) eliminated. However, a tridiagonal matrix problem is not a guarantee that we
can find a solution. The matrix \( {\bf A} \) which rephrases a second derivative in a discretized form

<p>&nbsp;<br>
$$
    {\bf A} = \left(\begin{array}{cccccc}
                          2 & -1 & 0 & 0  &0  & 0\\
                          -1 & 2 & -1 &0 &0 &0 \\
                          0 & -1 & 2 & -1 & 0& 0 \\
                          0 & \dots   & \dots & \dots   &\dots & \dots \\
                          0 &0   &0  &-1  &2& -1 \\
                          0 &  0  &0  &0   &-1 & 2 \\
                      \end{array} \right),
$$
<p>&nbsp;<br>

fulfills the condition of a weak dominance of the diagonal, with
\( |b_1| > |c_1| \), \( |b_n| > |a_n| \) and  \( |b_k| \ge |a_k|+|c_k| \) for \( k=2,3,\dots,n-1 \).
This is a relevant but not sufficient condition to guarantee that the matrix \( {\bf A} \) yields a solution to a linear
equation problem. The matrix needs also to be irreducible. A tridiagonal irreducible matrix means that all the elements \( a_i \) and
\( c_i \) are non-zero. If these two conditions are present, then \( {\bf A} \) is nonsingular and has a unique LU decomposition.

<p>

</section>


<section>

<h2>Project 1, hints  <a name="___sec121"></a></h2>

When setting up the algo it is useful to note that the different
operations on the matrix (here as a \( 4\times 4 \) case  with diagonals
\( d_i \) and off-diagonals \( e_i \)

<p>&nbsp;<br>
$$
   \left(\begin{array}{cccc}
                          d_1 & e_1 & 0 & 0 \\
                          e_1 & d_2 & e_2 & 0 \\
                          0 & e_2 & d_3 & e_3 \\
                          0 & 0 & e_3 & d_4
                      \end{array} \right)\rightarrow
   \left(\begin{array}{cccc}
                          d_1 & e_1 & 0 & 0 \\
                          0 & \tilde{d}_2 & e_2 & 0 \\
                          0 & e_2 & d_3 & e_3 \\
                          0 & 0 & e_3 & d_4
                      \end{array} \right)\rightarrow
   \left(\begin{array}{cccc}
                          d_1 & e_1 & 0 & 0 \\
                          0 & \tilde{d}_2 & e_2 & 0 \\
                          0 & 0 & \tilde{d}_3 & e_3 \\
                          0 & 0 & e_3 & d_4
                      \end{array} \right)
$$
<p>&nbsp;<br>

and finally

<p>&nbsp;<br>
$$
   \left(\begin{array}{cccc}
                          d_1 & e_1 & 0 & 0 \\
                          0 & \tilde{d}_2 & e_2 & 0 \\
                          0 & 0 & \tilde{d}_3 & e_3 \\
                          0 & 0 & 0 & \tilde{d}_4
                      \end{array} \right)
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>Project 1, hints  <a name="___sec122"></a></h2>

We notice the sub-blocks which get repeated

<p>&nbsp;<br>
$$
   \left(\begin{array}{cccc}
                          d_1 & e_1 & 0 & 0 \\
                          0 & \tilde{d}_2 & e_2 & 0 \\
                          0 & 0 & \tilde{d}_3 & e_3 \\
                          0 & 0 & 0 & \tilde{d}_4
                      \end{array} \right)
$$
<p>&nbsp;<br>

The matrices we often end up with in rewriting for for example partial differential equations,
have the feature that all leading principal submatrices are non-singular. If the matrix
is symmetric as well it can be rewritten as \( A=LDL^T \) with \( D \) the diagonal and we have the
following relations
\( a_{11} = d_1 \), \( a_{k,k-1}=e_{k-1}d_{k-1} \) for \( k=2,\dots,n \) and finally

<p>&nbsp;<br>
$$
a_{kk} = d_k+e_{k-1}^2d_{k-1}=d_k+e_{k-1}a_{k,k-1}
$$
<p>&nbsp;<br>

for \( k=2,\dots,n \).

<p>

</section>


<section>

<h2>Linear Algebra Methods  <a name="___sec123"></a></h2>

<ul>
  <p><li> Gaussian elimination, \( O(2/3n^3) \) flops, general matrix</li>
  <p><li> LU decomposition, upper triangular and lower tridiagonal matrices, \( O(2/3n^3) \) flops, general matrix. Get easily the inverse, determinant and can solve linear equations with back-substitution only, \( O(n^2) \) flops</li>
  <p><li> Cholesky decomposition \( A=LL^T \). Real symmetric or hermitian positive definite matrix, \( O(1/3n^3) \) flops.</li>
  <p><li> Tridiagonal linear systems, important for differential equations. Normally positive definite and non-singular. \( O(8n) \) flops for symmetric. \( A=LDL^T \) with \( D \) the diagonal. Special case of banded matrices.</li>
  <p><li> Singular value decomposition</li>
  <p><li> the QR method will be discussed in chapter 7 in connection with eigenvalue systems. \( O(4/3n^3) \) flops. !split</li>
</ul>
<p>

<h2>LU Decomposition  <a name="___sec124"></a></h2>

The LU decomposition method means that we can rewrite
this matrix as the product of two matrices \( {\bf L} \) and \( {\bf U} \)
where

<p>&nbsp;<br>
$$
\tag{7}
   \left(\begin{array}{cccc}
                          a_{11} & a_{12} & a_{13} & a_{14} \\
                          a_{21} & a_{22} & a_{23} & a_{24} \\
                          a_{31} & a_{32} & a_{33} & a_{34} \\
                          a_{41} & a_{42} & a_{43} & a_{44}
                      \end{array} \right)
                      = \left( \begin{array}{cccc}
                              1  & 0      & 0      & 0 \\
                          l_{21} & 1      & 0      & 0 \\
                          l_{31} & l_{32} & 1      & 0 \\
                          l_{41} & l_{42} & l_{43} & 1
                      \end{array} \right)
                        \left( \begin{array}{cccc}
                          u_{11} & u_{12} & u_{13} & u_{14} \\
                               0 & u_{22} & u_{23} & u_{24} \\
                               0 & 0      & u_{33} & u_{34} \\
                               0 & 0      &  0     & u_{44}
             \end{array} \right).
$$
<p>&nbsp;<br>

LU decomposition forms the backbone of other algorithms in linear algebra, such as the
solution of linear equations given by

<p>&nbsp;<br>
$$
\begin{align}
 a_{11}x_1 +a_{12}x_2 +a_{13}x_3 + a_{14}x_4=&w_1 \nonumber \\
a_{21}x_1 + a_{22}x_2 + a_{23}x_3 + a_{24}x_4=&w_2 \nonumber \\
a_{31}x_1 + a_{32}x_2 + a_{33}x_3 + a_{34}x_4=&w_3 \nonumber \\
a_{41}x_1 + a_{42}x_2 + a_{43}x_3 + a_{44}x_4=&w_4.  \nonumber
\end{align}
$$
<p>&nbsp;<br>

The above set of equations is conveniently solved by using LU decomposition as an intermediate step.

<p>
The matrix \( {\bf A}\in \mathbb{R}^{n\times n} \) has an LU factorization if the determinant
is different from zero. If the LU factorization exists and \( {\bf A} \) is non-singular, then the LU factorization
is unique and the determinant is given by

<p>&nbsp;<br>
$$
det\{{\bf A}\}=det\{{\bf LU}\}= det\{{\bf L}\}det\{{\bf U}\}=u_{11}u_{22}\dots u_{nn}.
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>LU Decomposition, why?  <a name="___sec125"></a></h2>

There are at least three main advantages with LU decomposition compared with standard Gaussian elimination:

<ul>
  <p><li> It is straightforward to compute the determinant of a matrix</li>
  <p><li> If we have to solve sets of linear equations with the same matrix but with different vectors \( {\bf y} \), the number of FLOPS is of the order \( n^3 \).</li>
  <p><li> The invers is such an operation !split</li>
</ul>
<p>

<h2>LU Decomposition, linear equations  <a name="___sec126"></a></h2>

With the LU decomposition it is rather
simple to solve a system of linear equations

<p>&nbsp;<br>
$$
\begin{align}
 a_{11}x_1 +a_{12}x_2 +a_{13}x_3 + a_{14}x_4=&w_1 \nonumber \\
a_{21}x_1 + a_{22}x_2 + a_{23}x_3 + a_{24}x_4=&w_2 \nonumber \\
a_{31}x_1 + a_{32}x_2 + a_{33}x_3 + a_{34}x_4=&w_3 \nonumber \\
a_{41}x_1 + a_{42}x_2 + a_{43}x_3 + a_{44}x_4=&w_4. \nonumber
\end{align}
$$
<p>&nbsp;<br>


<p>
This can be written in matrix form as

<p>&nbsp;<br>
$$ {\bf Ax}={\bf w}. $$
<p>&nbsp;<br>


<p>
where \( {\bf A} \) and \( {\bf w} \) are known and we have to solve for
\( {\bf x} \). Using the LU dcomposition we write

<p>&nbsp;<br>
$$ {\bf A} {\bf x} \equiv {\bf L} {\bf U} {\bf x} ={\bf w}. $$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>LU Decomposition, linear equations  <a name="___sec127"></a></h2>

The previous equation can be calculated in two steps

<p>&nbsp;<br>
$$ {\bf L} {\bf y} = {\bf w};\qquad {\bf Ux}={\bf y}. $$
<p>&nbsp;<br>


<p>
To show that this is correct we use to the LU decomposition
to rewrite our system of linear equations as

<p>&nbsp;<br>
$$  {\bf LUx}={\bf w}, $$
<p>&nbsp;<br>

and since the determinat of \( {\bf L} \) is equal to 1 (by construction
since the diagonals of \( {\bf L} \) equal 1) we can use the inverse of
\( {\bf L} \) to obtain

<p>&nbsp;<br>
$$
   {\bf Ux}={\bf L^{-1}w}={\bf y},
$$
<p>&nbsp;<br>

which yields the intermediate step

<p>&nbsp;<br>
$$
   {\bf L^{-1}w}={\bf y}
$$
<p>&nbsp;<br>

and as soon as we have \( {\bf y} \) we can obtain \( {\bf x} \)
through \( {\bf Ux}={\bf y} \).

<p>

</section>


<section>

<h2>LU Decomposition, why?  <a name="___sec128"></a></h2>

For our four-dimentional example this takes the form

<p>&nbsp;<br>
$$
\begin{align}
 y_1=&w_1 \nonumber\\
l_{21}y_1 + y_2=&w_2\nonumber \\
l_{31}y_1 + l_{32}y_2 + y_3 =&w_3\nonumber \\
l_{41}y_1 + l_{42}y_2 + l_{43}y_3 + y_4=&w_4. \nonumber
\end{align}
$$
<p>&nbsp;<br>


<p>
and

<p>&nbsp;<br>
$$
\begin{align}
 u_{11}x_1 +u_{12}x_2 +u_{13}x_3 + u_{14}x_4=&y_1 \nonumber\\
u_{22}x_2 + u_{23}x_3 + u_{24}x_4=&y_2\nonumber \\
u_{33}x_3 + u_{34}x_4=&y_3\nonumber \\
u_{44}x_4=&y_4  \nonumber
\end{align}
$$
<p>&nbsp;<br>


<p>
This example shows the basis for the algorithm
needed to solve the set of \( n \) linear equations.

<p>

</section>


<section>

<h2>LU Decomposition, linear equations  <a name="___sec129"></a></h2>

The algorithm goes as follows

<ul>
  <p><li> Set up the matrix \( \bf A \) and the vector \( \bf w \) with their correct dimensions. This determines the dimensionality of the unknown vector \( \bf x \).</li>
  <p><li> Then LU decompose the matrix \( \bf A \) through a call to the function <code>ludcmp(double a, int n, int indx, double &d)</code>. This functions returns the LU decomposed matrix \( \bf A \), its determinant and the vector indx which keeps track of the number of interchanges of rows. If the determinant is zero, the solution is malconditioned.</li>
  <p><li> Thereafter you call the function  <code>lubksb(double a, int n, int indx, double w)</code> which uses the LU decomposed matrix \( \bf A \) and the vector \( \bf w \) and returns \( \bf x \) in the same place as \( \bf w \). Upon exit the original content in \( \bf w \) is destroyed. If you wish to keep this information, you should make a backup of it in your calling function.</li>
</ul>
<p>


</section>


<section>

<h2>LU Decomposition, the inverse of a matrix  <a name="___sec130"></a></h2>

If the inverse exists then

<p>&nbsp;<br>
$$
   {\bf A}^{-1}{\bf A}={\bf I},
$$
<p>&nbsp;<br>

the identity matrix. With an LU decomposed matrix we can rewrite the last equation as

<p>&nbsp;<br>
$$
   {\bf LU}{\bf A}^{-1}={\bf I}.
$$
<p>&nbsp;<br>

If we assume that the first column (that is column 1) of the inverse matrix
can be written as a vector with unknown entries

<p>&nbsp;<br>
$$
    {\bf A}_1^{-1}= \left( \begin{array}{c}

                              a_{11}^{-1} \\
                              a_{21}^{-1} \\
                              \dots \\
                              a_{n1}^{-1} \\
                    \end{array} \right),
$$
<p>&nbsp;<br>

then we have a linear set of equations

<p>&nbsp;<br>
$$
    {\bf LU}\left( \begin{array}{c}

                              a_{11}^{-1} \\
                              a_{21}^{-1} \\
                              \dots \\
                              a_{n1}^{-1} \\
                    \end{array} \right) =\left( \begin{array}{c}
                               1 \\
                              0 \\
                              \dots \\
                              0 \\
                    \end{array} \right).
$$
<p>&nbsp;<br>


<p>

</section>


<section>

<h2>LU Decomposition, the inverse  <a name="___sec131"></a></h2>

In a similar way we can compute the unknow entries of the second column,

<p>&nbsp;<br>
$$
    {\bf LU}\left( \begin{array}{c}

                              a_{12}^{-1} \\
                              a_{22}^{-1} \\
                              \dots \\
                              a_{n2}^{-1} \\
                    \end{array} \right) =\left( \begin{array}{c}
                                0 \\
                              1 \\
                              \dots \\
                              0 \\
                    \end{array} \right),
$$
<p>&nbsp;<br>

and continue till we have solved all \( n \) sets of linear equations.

<p>

</section>


<section>

<h2>How to use the Library functions  <a name="___sec132"></a></h2>

Standard C/C++: fetch the files <code>lib.cpp</code> and <code>lib.h</code>. You can make a directory where you store
these files, and eventually its compiled version lib.o. The example here is program1.cpp from
chapter 6 and performs the matrix inversion.

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">//  Simple matrix inversion example</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;new&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;cstdio&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;cstdlib&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;cmath&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;cstring&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &quot;lib.h&quot;</span>

<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span>

<span style="color: #999999; font-style: italic">/* function declarations */</span>

<span style="color: #6ab825; font-weight: bold">void</span> <span style="color: #447fcf">inverse</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">**,</span> <span style="color: #6ab825; font-weight: bold">int</span><span style="color: #d0d0d0">);</span>
</pre></div>
<p>

</section>


<section>

<h2>How to use the Library functions  <a name="___sec133"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">void</span> <span style="color: #447fcf">inverse</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">**a,</span> <span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">n)</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">int</span>          <span style="color: #d0d0d0">i,j,</span> <span style="color: #d0d0d0">*indx;</span>
  <span style="color: #6ab825; font-weight: bold">double</span>       <span style="color: #d0d0d0">d,</span> <span style="color: #d0d0d0">*col,</span> <span style="color: #d0d0d0">**y;</span>
  <span style="color: #999999; font-style: italic">// allocate space in memory</span>
  <span style="color: #d0d0d0">indx</span> <span style="color: #d0d0d0">=</span> <span style="color: #6ab825; font-weight: bold">new</span> <span style="color: #6ab825; font-weight: bold">int</span><span style="color: #d0d0d0">[n];</span>
  <span style="color: #d0d0d0">col</span>  <span style="color: #d0d0d0">=</span> <span style="color: #6ab825; font-weight: bold">new</span> <span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">[n];</span>
  <span style="color: #d0d0d0">y</span>    <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">**)</span> <span style="color: #d0d0d0">matrix(n,</span> <span style="color: #d0d0d0">n,</span> <span style="color: #6ab825; font-weight: bold">sizeof</span><span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">));</span>
  <span style="color: #d0d0d0">ludcmp(a,</span> <span style="color: #d0d0d0">n,</span> <span style="color: #d0d0d0">indx,</span> <span style="color: #d0d0d0">&amp;d);</span>   <span style="color: #999999; font-style: italic">// LU decompose  a[][]</span>
  <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\n\nLU form of matrix of a[][]:\n&quot;</span><span style="color: #d0d0d0">);</span>
  <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
    <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">);</span>
    <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(j</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">j++)</span> <span style="color: #d0d0d0">{</span>
      <span style="color: #d0d0d0">printf(</span><span style="color: #ed9d13">&quot; a[%2d][%2d] = %12.4E&quot;</span><span style="color: #d0d0d0">,i,</span> <span style="color: #d0d0d0">j,</span> <span style="color: #d0d0d0">a[i][j]);</span>
</pre></div>
<p>

</section>


<section>

<h2>How to use the Library functions  <a name="___sec134"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #999999; font-style: italic">// find inverse of a[][] by columns</span>
  <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(j</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">j++)</span> <span style="color: #d0d0d0">{</span>
    <span style="color: #999999; font-style: italic">// initialize right-side of linear equations</span>
    <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">col[i]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.0</span><span style="color: #d0d0d0">;</span>
    <span style="color: #d0d0d0">col[j]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1.0</span><span style="color: #d0d0d0">;</span>
    <span style="color: #d0d0d0">lubksb(a,</span> <span style="color: #d0d0d0">n,</span> <span style="color: #d0d0d0">indx,</span> <span style="color: #d0d0d0">col);</span>
    <span style="color: #999999; font-style: italic">// save result in y[][]</span>
    <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">y[i][j]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">col[i];</span>
  <span style="color: #d0d0d0">}</span>   <span style="color: #999999; font-style: italic">//j-loop over columns</span>
  <span style="color: #999999; font-style: italic">// return the inverse matrix in a[][]</span>
  <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
    <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(j</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n;</span> <span style="color: #d0d0d0">j++)</span> <span style="color: #d0d0d0">a[i][j]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">y[i][j];</span>

  <span style="color: #d0d0d0">free_matrix((</span><span style="color: #6ab825; font-weight: bold">void</span> <span style="color: #d0d0d0">**)</span> <span style="color: #d0d0d0">y);</span>     <span style="color: #999999; font-style: italic">// release local memory</span>
  <span style="color: #6ab825; font-weight: bold">delete</span> <span style="color: #d0d0d0">[]</span> <span style="color: #d0d0d0">col;</span>
  <span style="color: #6ab825; font-weight: bold">delete</span> <span style="color: #d0d0d0">[]indx;</span>
<span style="color: #d0d0d0">}</span>  <span style="color: #999999; font-style: italic">// End: function inverse()</span>
</pre></div>
<p>

</section>


<section>

<h2>How to use the Library functions  <a name="___sec135"></a></h2>

For Fortran users:

<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">PROGRAM </span><span style="color: #40ffff">matrix</span>
  <span style="color: #6ab825; font-weight: bold">USE </span><span style="color: #40ffff">constants</span>
  <span style="color: #6ab825; font-weight: bold">USE </span><span style="color: #40ffff">F90library</span>
  <span style="color: #6ab825; font-weight: bold">IMPLICIT NONE</span>
  <span style="color: #999999; font-style: italic">!      The definition of the matrix, using dynamic allocation</span>
  <span style="color: #6ab825; font-weight: bold">REAL</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">DP</span><span style="color: #d0d0d0">),</span> <span style="color: #6ab825; font-weight: bold">ALLOCATABLE</span><span style="color: #d0d0d0">,</span> <span style="color: #6ab825; font-weight: bold">DIMENSION</span><span style="color: #d0d0d0">(:,:)</span> <span style="color: #6ab825; font-weight: bold">::</span> <span style="color: #40ffff">a</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">ainv</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">unity</span>
  <span style="color: #999999; font-style: italic">!      the determinant</span>
  <span style="color: #6ab825; font-weight: bold">REAL</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">DP</span><span style="color: #d0d0d0">)</span> <span style="color: #6ab825; font-weight: bold">::</span> <span style="color: #40ffff">d</span>
  <span style="color: #999999; font-style: italic">!      The size of the matrix</span>
  <span style="color: #6ab825; font-weight: bold">INTEGER</span> <span style="color: #6ab825; font-weight: bold">::</span> <span style="color: #40ffff">n</span>
  <span style="color: #a61717; background-color: #e3d2d2">....</span>
  <span style="color: #999999; font-style: italic">!      Allocate now place in heap for a</span>
  <span style="color: #6ab825; font-weight: bold">ALLOCATE</span> <span style="color: #d0d0d0">(</span> <span style="color: #40ffff">a</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">n</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">n</span><span style="color: #d0d0d0">),</span> <span style="color: #40ffff">ainv</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">n</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">n</span><span style="color: #d0d0d0">),</span> <span style="color: #40ffff">unity</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">n</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">n</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">)</span>
</pre></div>
<p>

</section>


<section>

<h2>How to use the Library functions  <a name="___sec136"></a></h2>

For Fortran users:

<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #6ab825; font-weight: bold">WRITE</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">6</span><span style="color: #d0d0d0">,*)</span> <span style="color: #ed9d13">&#39; The matrix before inversion&#39;</span>
  <span style="color: #6ab825; font-weight: bold">WRITE</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">6</span><span style="color: #d0d0d0">,</span><span style="color: #ed9d13">&#39;(3F12.6)&#39;</span><span style="color: #d0d0d0">)</span> <span style="color: #40ffff">a</span>
  <span style="color: #40ffff">ainv</span><span style="color: #d0d0d0">=</span><span style="color: #40ffff">a</span>
  <span style="color: #6ab825; font-weight: bold">CALL </span><span style="color: #40ffff">matinv</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">ainv</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">n</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">d</span><span style="color: #d0d0d0">)</span>
  <span style="color: #a61717; background-color: #e3d2d2">....</span>
  <span style="color: #999999; font-style: italic">!      get the unity matrix</span>
  <span style="color: #40ffff">unity</span><span style="color: #d0d0d0">=</span><span style="color: #24909d">MATMUL</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">ainv</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">a</span><span style="color: #d0d0d0">)</span>
  <span style="color: #6ab825; font-weight: bold">WRITE</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">6</span><span style="color: #d0d0d0">,*)</span> <span style="color: #ed9d13">&#39; The unity matrix&#39;</span>
  <span style="color: #6ab825; font-weight: bold">WRITE</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">6</span><span style="color: #d0d0d0">,</span><span style="color: #ed9d13">&#39;(3F12.6)&#39;</span><span style="color: #d0d0d0">)</span> <span style="color: #40ffff">unity</span>
  <span style="color: #999999; font-style: italic">!      deallocate all arrays</span>
  <span style="color: #6ab825; font-weight: bold">DEALLOCATE</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">a</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">ainv</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">unity</span><span style="color: #d0d0d0">)</span>
<span style="color: #6ab825; font-weight: bold">END PROGRAM </span><span style="color: #40ffff">matrix</span>
</pre></div>

<h1>Week 36  <a name="___sec137"></a></h1>


</section>


<section>

<h2>Overview of week 36  <a name="___sec138"></a></h2>

<div class="alert alert-block alert-block alert-text-normal">
<b>Linear Algebra.</b>
<p>

<ul>
  <p><li> Monday: Repetition from last week</li>
  <p><li> Discussion of Project 1, deadline 16 September (noon).</li>
  <p><li> Gaussian elimination, LU decomposition and linear equations</li>
  <p><li> Inverse of a matrix.</li>
  <p><li> Tuesday: Further discussion of linear algebra methods.</li>
  <p><li> Dynamic memory allocation in C/C++ and Fortran2008, use of the libraries like Armadillo for C++ users. How to use the C/C++ and Fortran 90/95 libraries. Programming classes in C++.</li>
  <p><li> Discussion of version control. Dropbox and GIT.</li>
  <p><li> Computer-Lab: Project 1.</li>
</ul>
</div>


<p>

</section>


<section>

<h2>Object orientation  <a name="___sec139"></a></h2>

Why object orientation?

<ul>
  <p><li> Three main topics: objects, class hierarchies and polymorphism</li>
  <p><li> The aim here is to be to be able to write a more general code which can easily be tailored to new situations.</li>
  <p><li> {\bf Polymorphism} is a term used in software development to describe a variety of techniques employed by programmers to create flexible and reusable software components. The term is Greek and it loosely translates to "many forms". Strategy: try to single out the variables needed to describe a given system and those needed to describe a given solver. !split</li>
</ul>
<p>

<h2>Object orientation  <a name="___sec140"></a></h2>

In programming languages, a polymorphic object is an entity, such as a variable or a procedure, that can hold or operate on values of differing types during the program's execution. Because a polymorphic object can operate on a variety of values and types, it can also be used in a variety of programs, sometimes with little or no change by the programmer. The idea of write once, run many, also known as code reusability, is an important characteristic to the programming paradigm known as Object-Oriented Programming (OOP).

<p>
OOP describes an approach to programming where a program is viewed as a collection of interacting, but mostly independent software components. These software components are known as objects in OOP and they are typically implemented in a programming language as an entity that encapsulates both data and procedures.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec141"></a></h2>

In Fortran a vector or matrix start with \( 1 \), but it is easy
to change a vector so that it starts with zero or even a negative number.
If we have a double precision Fortran vector  which starts at \( -10 \) and ends at \( 10 \), we could declare it as
<code>REAL(KIND=8) ::  vector(-10:10)</code>. Similarly, if we want to start at zero and end at 10 we could write
<code>REAL(KIND=8) ::  vector(0:10)</code>.
We have also seen that Fortran  allows us to write a matrix addition \( {\bf A} = {\bf B}+{\bf C} \) as
<code>A = B + C</code>.  This means that we have overloaded the addition operator so that it translates this operation into
two loops and an addition of two matrix elements \( a_{ij} = b_{ij}+c_{ij} \).

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec142"></a></h2>

The way the matrix addition is written is very close to the way we express this relation mathematically. The benefit for the
programmer is that our code is easier to read. Furthermore, such a way of coding makes it  more likely  to spot eventual
errors as well.

<p>
In Ansi C and C++ arrays start by default from \( i=0 \).  Moreover, if we  wish to add two matrices we need to explicitely write out
the two loops as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">   <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(i=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">i++)</span> <span style="color: #d0d0d0">{</span>
      <span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(j=</span><span style="color: #3677a9">0</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">j++)</span> <span style="color: #d0d0d0">{</span>
         <span style="color: #d0d0d0">a[i][j]=b[i][j]+c[i][j]</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec143"></a></h2>

However,
the strength of C++ is the possibility
to define new data types, tailored to some particular problem.
Via new data types and overloading of operations such as addition and subtraction, we can easily define
sets of operations and data types which allow us to write a matrix addition in exactly the same
way as we would do in Fortran.  We could also change the way we declare a C++ matrix elements \( a_{ij} \), from  \( a[i][j] \)
to say \( a(i,j) \), as we would do in Fortran. Similarly, we could also change the default range from \( 0:n-1 \) to \( 1:n \).

<p>
To achieve this we need to introduce two important entities in C++ programming, classes and templates.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec144"></a></h2>

The function and class declarations are fundamental concepts within C++.  Functions are abstractions
which encapsulate an algorithm or parts of it and perform specific tasks in a program.
We have already met several examples on how to use  functions.
Classes can be defined as abstractions which encapsulate
data and operations on these data.
The data can be very complex data structures  and the class can contain particular functions
which operate on these data. Classes allow therefore for a higher level of abstraction in computing.
The elements (or components) of the data
type are the class data members, and the procedures are the class
member functions.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec145"></a></h2>

Classes are user-defined tools used to create multi-purpose software which can be reused by other classes or functions.
These user-defined data types contain data (variables) and
functions operating on the data.

<p>
A simple example is that of a point in two dimensions.
The data could be the \( x \) and \( y \) coordinates of a given  point. The functions
we define could be simple read and write functions or the possibility to compute the distance between two points.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec146"></a></h2>

C++ has a class complex in its standard
template library (STL). The standard usage in a given function could then look like

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">// Program to calculate addition and multiplication of two complex numbers</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;cmath&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;complex&gt;</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">()</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #d0d0d0">complex&lt;</span><span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">&gt;</span> <span style="color: #d0d0d0">x(</span><span style="color: #3677a9">6.1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">8.2</span><span style="color: #d0d0d0">),</span> <span style="color: #d0d0d0">y(</span><span style="color: #3677a9">0.5</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">1.3</span><span style="color: #d0d0d0">);</span>
  <span style="color: #999999; font-style: italic">// write out x+y</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">y</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">x*y</span>  <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
</pre></div>
<p>
where we add and multiply two complex numbers \( x=6.1+\imath 8.2 \) and \( y=0.5+\imath 1.3 \) with the obvious results
\( z=x+y=6.6+\imath 9.5 \) and \( z=x\cdot y= -7.61+\imath 12.03 \).

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec147"></a></h2>

We proceed by  splitting our task in three files.

<p>
We define first a header file complex.h  which contains the declarations of
the class. The header file contains the class declaration (data and
functions), declaration of stand-alone functions, and all inlined
functions, starting as follows

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #cd2828; font-weight: bold">#ifndef Complex_H</span>
<span style="color: #cd2828; font-weight: bold">#define Complex_H</span>
<span style="color: #999999; font-style: italic">//   various include statements and definitions</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;          </span><span style="color: #999999; font-style: italic">// Standard ANSI-C++ include files</span>
<span style="color: #cd2828; font-weight: bold">#include &lt;new&gt;</span>
<span style="color: #cd2828; font-weight: bold">#include ....</span>

<span style="color: #6ab825; font-weight: bold">class</span> <span style="color: #447fcf; text-decoration: underline">Complex</span>
<span style="color: #d0d0d0">{...</span>
<span style="color: #d0d0d0">definition</span> <span style="color: #d0d0d0">of</span> <span style="color: #d0d0d0">variables</span> <span style="color: #d0d0d0">and</span> <span style="color: #d0d0d0">their</span> <span style="color: #d0d0d0">character</span>
<span style="color: #d0d0d0">};</span>
<span style="color: #999999; font-style: italic">//   declarations of various functions used by the class</span>
<span style="color: #d0d0d0">...</span>
<span style="color: #cd2828; font-weight: bold">#endif</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec148"></a></h2>

Next we provide a file complex.cpp where the code and algorithms of
different functions (except inlined functions) declared within the
class are written.  The files <code>complex.h</code> and <code>complex.cpp</code> are normally
placed in a directory with other classes and libraries we have
defined.

<p>
Finally, we discuss here an example of a main program which uses this
particular class.  An example of a program which uses our complex
class is given below. In particular we would like our class to perform
tasks like declaring complex variables, writing out the real and
imaginary part and performing algebraic operations such as adding or
multiplying two complex numbers.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec149"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #cd2828; font-weight: bold">#include &quot;Complex.h&quot;</span>
<span style="color: #d0d0d0">...</span>  <span style="color: #d0d0d0">other</span> <span style="color: #d0d0d0">include</span> <span style="color: #d0d0d0">and</span> <span style="color: #d0d0d0">declarations</span>
<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #d0d0d0">main</span> <span style="color: #d0d0d0">()</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">a(</span><span style="color: #3677a9">0.1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">1.3</span><span style="color: #d0d0d0">);</span>    <span style="color: #999999; font-style: italic">// we declare a complex variable a</span>
  <span style="color: #d0d0d0">Complex</span> <span style="color: #447fcf">b</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">3.0</span><span style="color: #d0d0d0">),</span> <span style="color: #d0d0d0">c(</span><span style="color: #3677a9">5.0</span><span style="color: #d0d0d0">,-</span><span style="color: #3677a9">2.3</span><span style="color: #d0d0d0">);</span>  <span style="color: #999999; font-style: italic">// we declare  complex variables b and c</span>
  <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">d</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">b;</span>         <span style="color: #999999; font-style: italic">//  we declare  a new complex variable d</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;d=&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">d</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;, a=&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">a</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;, b=&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">b</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
  <span style="color: #d0d0d0">d</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">a*c</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b/a;</span>  <span style="color: #999999; font-style: italic">//   we add, multiply and divide two complex numbers</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;Re(d)=&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">d.Re()</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;, Im(d)=&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">d.Im()</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>  <span style="color: #999999; font-style: italic">// write out of the real and imaginary parts</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec150"></a></h2>

We include the header file complex.h and define four different complex variables. These
are \( a=0.1+\imath 1.3 \), \( b=3.0+\imath 0 \) (note that if you don't define a value for the imaginary part  this is set to
zero), \( c=5.0-\imath 2.3 \) and \( d=b \).  Thereafter we have defined standard algebraic operations and the member functions
of the class which allows us to print out the real and imaginary part of a given variable.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec151"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">class</span> <span style="color: #447fcf; text-decoration: underline">Complex</span>
<span style="color: #d0d0d0">{</span>
<span style="color: #d0d0d0">private:</span>
   <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">re,</span> <span style="color: #d0d0d0">im;</span> <span style="color: #999999; font-style: italic">// real and imaginary part</span>
<span style="color: #d0d0d0">public:</span>
   <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">();</span>                              <span style="color: #999999; font-style: italic">// Complex c;</span>
   <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">re,</span> <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">im</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.0</span><span style="color: #d0d0d0">);</span> <span style="color: #999999; font-style: italic">// Definition of a complex variable;</span>
   <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c);</span>              <span style="color: #999999; font-style: italic">// Usage: Complex c(a);   // equate two complex variables</span>
   <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c);</span> <span style="color: #999999; font-style: italic">// c = a;   //  equate two complex variables, same as previous</span>
<span style="color: #d0d0d0">....</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec152"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #d0d0d0">~Complex</span> <span style="color: #d0d0d0">()</span> <span style="color: #d0d0d0">{}</span>                        <span style="color: #999999; font-style: italic">// destructor</span>
   <span style="color: #6ab825; font-weight: bold">double</span>   <span style="color: #d0d0d0">Re</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span><span style="color: #d0d0d0">;</span>        <span style="color: #999999; font-style: italic">// double real_part = a.Re();</span>
   <span style="color: #6ab825; font-weight: bold">double</span>   <span style="color: #d0d0d0">Im</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span><span style="color: #d0d0d0">;</span>        <span style="color: #999999; font-style: italic">// double imag_part = a.Im();</span>
   <span style="color: #6ab825; font-weight: bold">double</span>   <span style="color: #d0d0d0">abs</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span><span style="color: #d0d0d0">;</span>       <span style="color: #999999; font-style: italic">// double m = a.abs(); // modulus</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span>  <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span>  <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span>  <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">/</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span>  <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
<span style="color: #d0d0d0">};</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec153"></a></h2>

The class is defined via the statement <code>class Complex</code>. We must first use the key word
<code>class</code>, which in turn is followed by the user-defined variable name  <code>Complex</code>.
The body of the class, data and functions, is encapsulated  within the parentheses <code>{...}</code>.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec154"></a></h2>

Data and specific functions can be private, which means that they cannot be accessed from outside the class.
This means also that access cannot be inherited by other functions outside the class. If we use <code>protected</code>
instead of <code>private</code>, then data and functions can be inherited outside the class.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec155"></a></h2>

The key word <code>public</code> means  that data and functions can be accessed from outside the class.
Here we have defined several functions  which can be accessed by functions outside the class.
The declaration <code>friend</code> means that stand-alone functions can work on privately declared  variables  of the type
<code>(re, im)</code>.  Data members of a class should be declared as private variables.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec156"></a></h2>

The first public function we encounter is a so-called
constructor, which  tells how we declare a variable of type <code>Complex</code>
and how this variable is initialized. We have chose  three possibilities in the example above:

<p>
A declaration like <code>Complex c;</code> calls the member function <code>Complex()</code> which can have the following implementation

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">()</span> <span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">re</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">im</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>
meaning that it sets the real and imaginary parts to zero. Note the
way a member function is defined. The constructor is the first
function that is called when an object is instantiated.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec157"></a></h2>

Another possibility is

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">()</span> <span style="color: #d0d0d0">{}</span>
</pre></div>
<p>
which means that there is no initialization of the real and imaginary parts. The drawback is that a given compiler can then assign random values to a given variable.

<p>
A call like <code>Complex a(0.1,1.3);</code> means that we could call the member function `Complex(double, double)`as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">re_a,</span> <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">im_a)</span> <span style="color: #d0d0d0">{</span>
    <span style="color: #d0d0d0">re</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">re_a;</span> <span style="color: #d0d0d0">im</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">im_a;</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec158"></a></h2>

The simplest member function are those we defined to extract
the real and imaginary part of a variable. Here you have to recall that these are private data,
that is they invisible for users of the class.  We obtain a copy of these variables by defining the
functions

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Re</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">{</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">re;</span> <span style="color: #d0d0d0">}}</span> <span style="color: #999999; font-style: italic">//  getting the real part</span>
<span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Im</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">{</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">im;</span> <span style="color: #d0d0d0">}</span>  <span style="color: #999999; font-style: italic">//   and the imaginary part</span>
</pre></div>
<p>
Note that we have introduced   the declaration  <code>const</code>.  What does it mean?
This declaration means that a variabale cannot be changed within  a called function.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec159"></a></h2>

If we define a variable as
<code>const double p = 3;</code> and then try to change its value, we will get an error when we
compile our program. This means that constant arguments in functions cannot be changed.

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">// const arguments (in functions) cannot be changed:</span>
<span style="color: #6ab825; font-weight: bold">void</span> <span style="color: #447fcf">myfunc</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">c.re</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.2</span><span style="color: #d0d0d0">;</span> <span style="color: #999999; font-style: italic">/* ILLEGAL!! compiler error... */</span>  <span style="color: #d0d0d0">}</span>
</pre></div>
<p>
If we declare the function and try to change the value to \( 0.2 \), the compiler will complain by sending
an error message.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec160"></a></h2>

If we define a function to compute the absolute value of complex variable like

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">abs</span> <span style="color: #d0d0d0">()</span>  <span style="color: #d0d0d0">{</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">sqrt(re*re</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">im*im);}</span>
</pre></div>
<p>
without the constant declaration  and define thereafter a function
<code>myabs</code> as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #447fcf">myabs</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">c.abs();</span> <span style="color: #d0d0d0">}</span>   <span style="color: #999999; font-style: italic">// Not ok because c.abs() is not a const func.</span>
</pre></div>
<p>
the compiler would not allow the c.abs() call in myabs
since <code>Complex::abs</code> is not a constant member function.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec161"></a></h2>

Constant functions cannot change the object's state.
To avoid this we declare the function <code>abs</code> as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">abs</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">{</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">sqrt(re*re</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">im*im);</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec162"></a></h2>

C++ (and Fortran) allow for overloading of operators. That means we
can define algebraic operations on for example vectors or any
arbitrary object.  As an example, a vector addition of the type \( {\bf
c} = {\bf a} + {\bf b} \) means that we need to write a small part of
code with a for-loop over the dimension of the array.  We would rather
like to write this statement as <code>c = a+b;</code> as this makes the code much
more readable and close to eventual equations we want to code.  To
achieve this we need to extend the definition of operators.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec163"></a></h2>

Let us study the declarations in our complex class.
In our main function we have a statement like <code>d = b;</code>, which means
that we call <code>d.operator= (b)</code> and we have defined a so-called assignment operator
as a part of the class defined as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c)</span>
<span style="color: #d0d0d0">{</span>
   <span style="color: #d0d0d0">re</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">c.re;</span>
   <span style="color: #d0d0d0">im</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">c.im;</span>
   <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">*</span><span style="color: #6ab825; font-weight: bold">this</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">}</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec164"></a></h2>

With this function, statements like
<code>Complex d = b;</code> or <code>Complex d(b);</code>
make a new object \( d \), which becomes a copy of \( b \).
We can make simple implementations in terms of the assignment

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">*</span><span style="color: #6ab825; font-weight: bold">this</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">c;</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>
which  is a pointer to "this object", <code>*this</code> is the present object,
so <code>*this = c;</code> means setting the present object equal to \( c \), that is
<code>this->operator= (c);</code>.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec165"></a></h2>

The meaning of the addition operator \( + \) for Complex objects is defined in the
function
<code>Complex operator+ (const Complex& a, const Complex& b); // a+b</code>
The compiler translates <code>c = a + b;</code> into <code>c = operator+ (a, b);</code>.
Since this implies the call to function, it brings in an additional overhead. If speed
is crucial and this function call is performed inside a loop, then it is more difficult for a
given compiler to perform optimizations of a loop.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec166"></a></h2>

The solution to this is to inline functions.   We discussed inlining in chapter
2 of the lecture notes.
Inlining means that the function body is copied directly into
the calling code, thus avoiding calling the function.
Inlining is enabled by the inline keyword

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">inline</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(a.re</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b.re,</span> <span style="color: #d0d0d0">a.im</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b.im);</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>
Inline functions, with complete bodies must be written in the header file  complex.h.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec167"></a></h2>

Consider  the case <code>c = a + b;</code>
that is,  <code>c.operator= (operator+ (a,b));</code>
If <code>operator+</code>, <code>operator=</code> and the constructor <code>Complex(r,i)</code> all
are inline functions, this transforms to

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">c.re</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">a.re</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b.re;</span>
<span style="color: #d0d0d0">c.im</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">a.im</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b.im;</span>
</pre></div>
<p>
by the compiler, i.e., no function calls

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec168"></a></h2>

The stand-alone function <code>operator+</code> is a friend of the Complex  class

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">class</span> <span style="color: #447fcf; text-decoration: underline">Complex</span>
<span style="color: #d0d0d0">{</span>
   <span style="color: #d0d0d0">...</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
   <span style="color: #d0d0d0">...</span>
<span style="color: #d0d0d0">};</span>
</pre></div>
<p>
so it can read (and manipulate) the private data parts \( re \) and
\( im \) via

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">inline</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(a.re</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b.re,</span> <span style="color: #d0d0d0">a.im</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b.im);</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec169"></a></h2>

Since we do not need to alter the re and im variables, we can
get the values by Re() and Im(), and there is no need to be a
friend function

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">inline</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(a.Re()</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b.Re(),</span> <span style="color: #d0d0d0">a.Im()</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">b.Im());</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec170"></a></h2>

The multiplication functionality can now be extended to imaginary numbers by the following code

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">inline</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b)</span>
<span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">Complex(a.re*b.re</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">a.im*b.im,</span> <span style="color: #d0d0d0">a.im*b.re</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">a.re*b.im);</span>
</pre></div>
<p>
It will be convenient to inline all functions used by this operator.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec171"></a></h2>

To inline the complete expression <code>a*b;</code>, the constructors and
<code>operator=</code>  must also be inlined.  This can be achieved via the following piece of code

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">inline</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">()</span> <span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">re</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">im</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.0</span><span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">}</span>
<span style="color: #6ab825; font-weight: bold">inline</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">re_,</span> <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">im_)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">...</span> <span style="color: #d0d0d0">}</span>
<span style="color: #6ab825; font-weight: bold">inline</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">...</span> <span style="color: #d0d0d0">}</span>
<span style="color: #6ab825; font-weight: bold">inline</span> <span style="color: #d0d0d0">Complex::</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">...</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec172"></a></h2>


<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">// e, c, d are complex</span>
<span style="color: #d0d0d0">e</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">c*d;</span>
<span style="color: #999999; font-style: italic">// first compiler translation:</span>
<span style="color: #d0d0d0">e.</span><span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">(c,d));</span>
<span style="color: #999999; font-style: italic">// result of nested inline functions</span>
<span style="color: #999999; font-style: italic">// operator=, operator*, Complex(double,double=0):</span>
<span style="color: #d0d0d0">e.re</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">c.re*d.re</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">c.im*d.im;</span>
<span style="color: #d0d0d0">e.im</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">c.im*d.re</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">c.re*d.im;</span>
</pre></div>
<p>
The definitions <code>operator-</code> and <code>operator/</code> follow the same set up.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec173"></a></h2>

Finally, if we wish to write to file or another device a complex number using the simple syntax
<code>cout << c;</code>, we obtain this by defining
the effect of \( << \) for a Complex object as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">ostream&amp;</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">(ostream&amp;</span> <span style="color: #d0d0d0">o,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">o</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;(&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">c.Re()</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;,&quot;</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">c.Im()</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #ed9d13">&quot;) &quot;</span><span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">o;}</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes, templates  <a name="___sec174"></a></h2>

What if we wanted to make a class which takes integers
or floating point numbers with single precision?
A simple way to achieve this is copy and paste our class and replace <code>double</code> with for
example <code>int</code>.

<p>
C++  allows us to do this automatically via the usage of templates, which
are the C++ constructs for parameterizing parts of
classes. Class templates  is a template for producing classes. The declaration consists
of the keyword <code>template</code> followed by a list of template arguments enclosed in brackets.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec175"></a></h2>

We can therefore make a more general class by rewriting our original example as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">template</span><span style="color: #d0d0d0">&lt;</span><span style="color: #6ab825; font-weight: bold">class</span> <span style="color: #447fcf; text-decoration: underline">T</span><span style="color: #d0d0d0">&gt;</span>
<span style="color: #6ab825; font-weight: bold">class</span> <span style="color: #447fcf; text-decoration: underline">Complex</span>
<span style="color: #d0d0d0">{</span>
<span style="color: #d0d0d0">private:</span>
   <span style="color: #d0d0d0">T</span> <span style="color: #d0d0d0">re,</span> <span style="color: #d0d0d0">im;</span> <span style="color: #999999; font-style: italic">// real and imaginary part</span>
<span style="color: #d0d0d0">public:</span>
   <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">();</span>                              <span style="color: #999999; font-style: italic">// Complex c;</span>
   <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(T</span> <span style="color: #d0d0d0">re,</span> <span style="color: #d0d0d0">T</span> <span style="color: #d0d0d0">im</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">);</span> <span style="color: #999999; font-style: italic">// Definition of a complex variable;</span>
   <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c);</span>              <span style="color: #999999; font-style: italic">// Usage: Complex c(a);   // equate two complex variables</span>
   <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">c);</span> <span style="color: #999999; font-style: italic">// c = a;   //  equate two complex variables, same as previous</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec176"></a></h2>

We can therefore make a more general class by rewriting our original example as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">  <span style="color: #d0d0d0">~Complex</span> <span style="color: #d0d0d0">()</span> <span style="color: #d0d0d0">{}</span>                        <span style="color: #999999; font-style: italic">// destructor</span>
   <span style="color: #d0d0d0">T</span>   <span style="color: #d0d0d0">Re</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span><span style="color: #d0d0d0">;</span>        <span style="color: #999999; font-style: italic">// T real_part = a.Re();</span>
   <span style="color: #d0d0d0">T</span>   <span style="color: #d0d0d0">Im</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span><span style="color: #d0d0d0">;</span>        <span style="color: #999999; font-style: italic">// T imag_part = a.Im();</span>
   <span style="color: #d0d0d0">T</span>   <span style="color: #d0d0d0">abs</span> <span style="color: #d0d0d0">()</span> <span style="color: #6ab825; font-weight: bold">const</span><span style="color: #d0d0d0">;</span>       <span style="color: #999999; font-style: italic">// T m = a.abs(); // modulus</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span>  <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span>  <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">*</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span>  <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
   <span style="color: #6ab825; font-weight: bold">friend</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">/</span> <span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span>  <span style="color: #d0d0d0">a,</span> <span style="color: #6ab825; font-weight: bold">const</span> <span style="color: #d0d0d0">Complex&amp;</span> <span style="color: #d0d0d0">b);</span>
<span style="color: #d0d0d0">};</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec177"></a></h2>

What it says is that <code>Complex</code> is a parameterized type with \( T \) as a parameter and \( T \) has to be a type such as double
or float.
The class complex is now a class template
and we would define variables in a code as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">Complex&lt;</span><span style="color: #6ab825; font-weight: bold">double</span><span style="color: #d0d0d0">&gt;</span> <span style="color: #d0d0d0">a(</span><span style="color: #3677a9">10.0</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">5.1</span><span style="color: #d0d0d0">);</span>
<span style="color: #d0d0d0">Complex&lt;</span><span style="color: #6ab825; font-weight: bold">int</span><span style="color: #d0d0d0">&gt;</span> <span style="color: #d0d0d0">b(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">);</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec178"></a></h2>

Member functions of our class are defined by preceding the name of the function with the <code>template</code> keyword.
Consider the function we defined as <code>Complex:: Complex (double re_a, double im_a)</code>.
We would rewrite this function as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">template</span><span style="color: #d0d0d0">&lt;</span><span style="color: #6ab825; font-weight: bold">class</span> <span style="color: #447fcf; text-decoration: underline">T</span><span style="color: #d0d0d0">&gt;</span>
<span style="color: #d0d0d0">Complex&lt;T&gt;::</span> <span style="color: #d0d0d0">Complex</span> <span style="color: #d0d0d0">(T</span> <span style="color: #d0d0d0">re_a,</span> <span style="color: #d0d0d0">T</span> <span style="color: #d0d0d0">im_a)</span>
<span style="color: #d0d0d0">{</span> <span style="color: #d0d0d0">re</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">re_a;</span> <span style="color: #d0d0d0">im</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">im_a;</span> <span style="color: #d0d0d0">}</span>
</pre></div>
<p>
The member functions  are otherwise defined following ordinary member function definitions.

<p>

</section>


<section>

<h2>Programming classes  <a name="___sec179"></a></h2>

Here follows a very simple first class

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic">// Class to compute the square of a number</span>
<span style="color: #6ab825; font-weight: bold">class</span> <span style="color: #447fcf; text-decoration: underline">Squared</span><span style="color: #d0d0d0">{</span>
  <span style="color: #d0d0d0">public:</span>
    <span style="color: #999999; font-style: italic">// Default constructor, not used here</span>
    <span style="color: #d0d0d0">Squared(){}</span>

    <span style="color: #999999; font-style: italic">// Overload the function operator()</span>
    <span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #6ab825; font-weight: bold">operator</span><span style="color: #d0d0d0">()(</span><span style="color: #6ab825; font-weight: bold">double</span> <span style="color: #d0d0d0">x){</span>
      <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">x*x;</span>

<span style="color: #d0d0d0">};</span>
</pre></div>
<p>

</section>


<section>

<h2>Programming classes  <a name="___sec180"></a></h2>

and we would use it as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #cd2828; font-weight: bold">#include &lt;iostream&gt;</span>
<span style="color: #6ab825; font-weight: bold">using</span> <span style="color: #6ab825; font-weight: bold">namespace</span> <span style="color: #d0d0d0">std;</span>

<span style="color: #6ab825; font-weight: bold">int</span> <span style="color: #447fcf">main</span><span style="color: #d0d0d0">(){</span>
  <span style="color: #d0d0d0">Squared</span> <span style="color: #d0d0d0">s;</span>
  <span style="color: #d0d0d0">cout</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">s(</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;&lt;</span> <span style="color: #d0d0d0">endl;</span>
</pre></div>
<p>


</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.min.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

    // Display navigation controls in the bottom right corner
    controls: true,

    // Display progress bar (below the horiz. slider)
    progress: true,

    // Display the page number of the current slide
    slideNumber: true,

    // Push each slide change to the browser history
    history: false,

    // Enable keyboard shortcuts for navigation
    keyboard: true,

    // Enable the slide overview mode
    overview: true,

    // Vertical centering of slides
    //center: true,
    center: false,

    // Enables touch navigation on devices with touch input
    touch: true,

    // Loop the presentation
    loop: false,

    // Change the presentation direction to be RTL
    rtl: false,

    // Turns fragments on and off globally
    fragments: true,

    // Flags if the presentation is running in an embedded mode,
    // i.e. contained within a limited portion of the screen
    embedded: false,

    // Number of milliseconds between automatically proceeding to the
    // next slide, disabled when set to 0, this value can be overwritten
    // by using a data-autoslide attribute on your slides
    autoSlide: 0,

    // Stop auto-sliding after user input
    autoSlideStoppable: true,

    // Enable slide navigation via mouse wheel
    mouseWheel: false,

    // Hides the address bar on mobile devices
    hideAddressBar: true,

    // Opens links in an iframe preview overlay
    previewLinks: false,

    // Transition style
    transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

    // Transition speed
    transitionSpeed: 'default', // default/fast/slow

    // Transition style for full page slide backgrounds
    backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

    // Number of slides away from the current that are visible
    viewDistance: 3,

    // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

    // Parallax background size
    //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

    theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
    dependencies: [
        // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
        { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

        // Interpret Markdown in <section> elements
        { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

        // Syntax highlight for <code> elements
        { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

        // Zoom in and out with Alt+click
        { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

        // Speaker notes
        { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

        // Remote control your reveal.js presentation using a touch device
        //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

        // MathJax
        //{ src: 'reveal.js/plugin/math/math.js', async: true }
    ]
});

Reveal.initialize({

    // The "normal" size of the presentation, aspect ratio will be preserved
    // when the presentation is scaled to fit different resolutions. Can be
    // specified using percentage units.
    width:  960,
    height: 700,

    // Factor of the display size that should remain empty around the content
    margin: 0.1,

    // Bounds for smallest/largest possible scale to apply to content
    minScale: 0.2,
    maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
     end footer logo -->



</body>
</html>
